<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.237ba1bc08ffadef5a9e.css">html{box-sizing:border-box;margin:0;padding:0}*,:after,:before{box-sizing:inherit}body{margin:0!important;padding:0}a.anchor,a.anchor:hover,a.anchor:link{background:none!important}figure a.gatsby-resp-image-link{background:none}figure span.gatsby-resp-image-wrapper{max-width:100%!important}article .excerpt{display:none}.btn,.button{display:inline-block;background:none!important;border-radius:40px;line-height:40px;min-height:40px;min-width:80px;padding:0 12px;text-align:center;text-decoration:none;border:1px solid #666;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}@font-face{font-family:et-book;src:url(/et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot);src:url(/et-book/et-book-roman-line-figures/et-book-roman-line-figures.eot?#iefix) format("embedded-opentype"),url(/et-book/et-book-roman-line-figures/et-book-roman-line-figures.woff) format("woff"),url(/et-book/et-book-roman-line-figures/et-book-roman-line-figures.ttf) format("truetype"),url(/et-book/et-book-roman-line-figures/et-book-roman-line-figures.svg#etbookromanosf) format("svg");font-weight:400;font-style:normal}@font-face{font-family:et-book;src:url(/et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot);src:url(/et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.eot?#iefix) format("embedded-opentype"),url(/et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.woff) format("woff"),url(/et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.ttf) format("truetype"),url(/et-book/et-book-display-italic-old-style-figures/et-book-display-italic-old-style-figures.svg#etbookromanosf) format("svg");font-weight:400;font-style:italic}@font-face{font-family:et-book;src:url(/et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot);src:url(/et-book/et-book-bold-line-figures/et-book-bold-line-figures.eot?#iefix) format("embedded-opentype"),url(/et-book/et-book-bold-line-figures/et-book-bold-line-figures.woff) format("woff"),url(/et-book/et-book-bold-line-figures/et-book-bold-line-figures.ttf) format("truetype"),url(/et-book/et-book-bold-line-figures/et-book-bold-line-figures.svg#etbookromanosf) format("svg");font-weight:700;font-style:normal}@font-face{font-family:et-book-roman-old-style;src:url(/et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.eot);src:url(/et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.eot?#iefix) format("embedded-opentype"),url(/et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.woff) format("woff"),url(/et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.ttf) format("truetype"),url(/et-book/et-book-roman-old-style-figures/et-book-roman-old-style-figures.svg#etbookromanosf) format("svg");font-weight:400;font-style:normal}html{font-size:15px}body{width:87.5%;margin-left:auto;margin-right:auto;padding-left:12.5%;font-family:et-book,Palatino,Palatino Linotype,Palatino LT STD,Book Antiqua,Georgia,serif;background-color:#fffff8;color:#111;max-width:1400px;counter-reset:sidenote-counter}h1{font-weight:400;margin-top:4rem;margin-bottom:1.5rem;font-size:3.2rem;line-height:1}h2{margin-top:2.1rem;font-size:2.2rem}h2,h3{font-style:italic;font-weight:400;margin-bottom:1.4rem;line-height:1}h3{font-size:1.7rem;margin-top:2rem}hr{display:block;height:1px;width:55%;border:0;border-top:1px solid #ccc;margin:1em 0;padding:0}p.subtitle{font-style:italic;margin-top:1rem;margin-bottom:1rem;font-size:1.8rem;display:block;line-height:1}.numeral{font-family:et-book-roman-old-style}.danger{color:red}article{position:relative;padding:1rem 0}section{padding-top:1rem;padding-bottom:1rem}ol,p,ul{font-size:1.4rem;line-height:2rem}p{margin-top:1.4rem;margin-bottom:1.4rem;padding-right:0;vertical-align:baseline}div.epigraph{margin:5em 0}div.epigraph>blockquote{margin-top:3em;margin-bottom:3em}div.epigraph>blockquote,div.epigraph>blockquote>p{font-style:italic}div.epigraph>blockquote>footer{font-style:normal}div.epigraph>blockquote>footer>cite{font-style:italic}blockquote{font-size:1.4rem}blockquote p{width:55%;margin-right:40px;font-style:italic;color:#999}blockquote footer{width:55%;font-size:1.1rem;text-align:right}section>footer,section>p,section>table{width:55%;clear:left}section>ol,section>ul{width:55%;-webkit-padding-start:5%}li:not(:first-child){margin-top:.25rem}figure{padding:0;border:0;font-size:100%;font:inherit;max-width:55%;-webkit-margin-start:0;-webkit-margin-end:0;-webkit-margin-before:0;margin-block-start:0;-webkit-margin-after:0;margin-block-end:0;margin:0 0 3em}figcaption,figure{vertical-align:baseline}figcaption{margin-top:-2em;margin-bottom:0;font-size:1.1rem;font-style:italic;line-height:1.6;position:relative;max-width:40%}figure.fullwidth figcaption{max-width:80%}a:link,a:visited{color:inherit}a:link{text-decoration:none;border-bottom:1px solid #000;padding-bottom:.05em;margin-bottom:.05em;word-break:break-word}a.anchor:link,nav.navigation a{border-bottom:0;padding-bottom:0;margin-bottom:0}@media screen and (-webkit-min-device-pixel-ratio:0){a:link{background-position-y:101%,101%,101%}}img{max-width:100%}.sidenote{margin-bottom:2em!important}.marginnote,.sidenote{float:right;clear:right;width:45%;margin:0 -75% 0 5%;font-size:1.1rem;line-height:1.3;vertical-align:baseline;position:relative}.sidenote-number{counter-increment:sidenote-counter}.sidenote-number:after,.sidenote:before{font-family:et-book-roman-old-style;position:relative;vertical-align:baseline}.sidenote-number:after{content:counter(sidenote-counter);font-size:1rem;top:-.5rem;left:.1rem}.sidenote:before{content:counter(sidenote-counter) " ";font-size:1rem;top:-.5rem}blockquote .marginnote,blockquote .sidenote{margin-right:-82%;min-width:59%;text-align:left}div.fullwidth,table.fullwidth{width:100%}div.table-wrapper{overflow-x:auto}.sans,div.table-wrapper{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji}.sans{letter-spacing:.03em}code{font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:1rem;line-height:1.42}.sans>code{font-size:1.2rem}h1>code,h2>code,h3>code{font-size:.8em}.marginnote>code,.sidenote>code{font-size:1rem}pre.code{font-size:.9rem;width:52.5%;margin-left:2.5%;overflow-x:auto}pre.code.fullwidth{width:90%}.fullwidth{max-width:100%;clear:both}span.newthought{font-variant:small-caps;font-size:1.2em}input.margin-toggle{display:none}label.sidenote-number{display:inline}label.margin-toggle:not(.sidenote-number){display:none}.iframe-wrapper{position:relative;padding-bottom:56.25%;padding-top:25px;height:0}.iframe-wrapper iframe{position:absolute;top:0;left:0;width:100%;height:100%}@media (max-width:760px){body{padding-left:8%;padding-right:8%}body,hr,section>footer,section>p,section>table{width:100%}pre.code{width:97%}section>ol,section>ul{width:90%}figure{max-width:90%}figcaption,figure.fullwidth figcaption{margin-right:0;max-width:none}blockquote{margin-left:1.5em;margin-right:0}blockquote footer,blockquote p{width:100%}label.margin-toggle:not(.sidenote-number){display:inline}.marginnote,.sidenote{display:none}.margin-toggle:checked+.marginnote,.margin-toggle:checked+.sidenote{display:block;float:left;left:1rem;clear:both;width:95%;margin:1rem 2.5%;vertical-align:baseline;position:relative}label{cursor:pointer}div.table-wrapper,table{width:85%}img{width:100%}}:not(pre)>code[class*=language-]{font-size:.9em!important}.gatsby-highlight:after{content:"";display:block;clear:both}.gatsby-highlight{clear:both}h4{font-size:1.3em}.markdown-body ol,.markdown-body p,.markdown-body ul{font-size:inherit;line-height:inherit}.markdown-body blockquote{font-size:inherit}.markdown-body{box-sizing:border-box;min-width:200px;max-width:980px;margin:0 auto;padding:24px;letter-spacing:normal;border-bottom:1px solid #efefef}@media (max-width:767px){.markdown-body{padding:15px}}code[class*=language-],pre[class*=language-]{color:#000;background:none;text-shadow:0 1px #fff;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.markdown-body .octicon{display:inline-block;fill:currentColor;vertical-align:text-bottom}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#1b1f23;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before{width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' version='1.1' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")}.markdown-body{-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body details{display:block}.markdown-body summary{display:list-item}.markdown-body a{background-color:initial}.markdown-body a:active,.markdown-body a:hover{outline-width:0}.markdown-body strong{font-weight:inherit;font-weight:bolder}.markdown-body h1{margin:.67em 0}.markdown-body img{border-style:none}.markdown-body code,.markdown-body kbd,.markdown-body pre{font-family:monospace,monospace;font-size:1em}.markdown-body hr{box-sizing:initial;overflow:visible}.markdown-body input{font:inherit;margin:0;overflow:visible}.markdown-body [type=checkbox]{box-sizing:border-box;padding:0}.markdown-body *{box-sizing:border-box}.markdown-body input{font-family:inherit;font-size:inherit;line-height:inherit}.markdown-body a{color:#0366d6;text-decoration:none}.markdown-body a:hover{text-decoration:underline}.markdown-body strong{font-weight:600}.markdown-body hr{height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5}.markdown-body hr:after,.markdown-body hr:before{display:table;content:""}.markdown-body hr:after{clear:both}.markdown-body table{border-spacing:0;border-collapse:collapse}.markdown-body td,.markdown-body th{padding:0}.markdown-body details summary{cursor:pointer}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:0;margin-bottom:0}.markdown-body h1{font-size:32px}.markdown-body h1,.markdown-body h2{font-weight:600}.markdown-body h2{font-size:24px}.markdown-body h3{font-size:20px}.markdown-body h3,.markdown-body h4{font-weight:600}.markdown-body h4{font-size:16px}.markdown-body h5{font-size:14px}.markdown-body h5,.markdown-body h6{font-weight:600}.markdown-body h6{font-size:12px}.markdown-body p{margin-top:0;margin-bottom:10px}.markdown-body blockquote{margin:0}.markdown-body ol,.markdown-body ul{padding-left:0;margin-top:0;margin-bottom:0}.markdown-body ol ol,.markdown-body ul ol{list-style-type:lower-roman}.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol{list-style-type:lower-alpha}.markdown-body dd{margin-left:0}.markdown-body code,.markdown-body pre{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px}.markdown-body pre{margin-top:0;margin-bottom:0}.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button{margin:0;-webkit-appearance:none;appearance:none}.markdown-body :checked+.radio-label{position:relative;z-index:1;border-color:#0366d6}.markdown-body .border{border:1px solid #e1e4e8!important}.markdown-body .border-0{border:0!important}.markdown-body .border-bottom{border-bottom:1px solid #e1e4e8!important}.markdown-body .rounded-1{border-radius:3px!important}.markdown-body .bg-white{background-color:#fff!important}.markdown-body .bg-gray-light{background-color:#fafbfc!important}.markdown-body .text-gray-light{color:#6a737d!important}.markdown-body .pl-3,.markdown-body .px-3{padding-left:16px!important}.markdown-body .px-3{padding-right:16px!important}.markdown-body .f6{font-size:12px!important}.markdown-body .lh-condensed{line-height:1.25!important}.markdown-body .text-bold{font-weight:600!important}.markdown-body .pl-c{color:#6a737d}.markdown-body .pl-c1,.markdown-body .pl-s .pl-v{color:#005cc5}.markdown-body .pl-e,.markdown-body .pl-en{color:#6f42c1}.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi{color:#24292e}.markdown-body .pl-ent{color:#22863a}.markdown-body .pl-k{color:#d73a49}.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre{color:#032f62}.markdown-body .pl-smw,.markdown-body .pl-v{color:#e36209}.markdown-body .pl-bu{color:#b31d28}.markdown-body .pl-ii{color:#fafbfc;background-color:#b31d28}.markdown-body .pl-c2{color:#fafbfc;background-color:#d73a49}.markdown-body .pl-c2:before{content:"^M"}.markdown-body .pl-sr .pl-cce{font-weight:700;color:#22863a}.markdown-body .pl-ml{color:#735c0f}.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms{font-weight:700;color:#005cc5}.markdown-body .pl-mi{font-style:italic;color:#24292e}.markdown-body .pl-mb{font-weight:700;color:#24292e}.markdown-body .pl-md{color:#b31d28;background-color:#ffeef0}.markdown-body .pl-mi1{color:#22863a;background-color:#f0fff4}.markdown-body .pl-mc{color:#e36209;background-color:#ffebda}.markdown-body .pl-mi2{color:#f6f8fa;background-color:#005cc5}.markdown-body .pl-mdr{font-weight:700;color:#6f42c1}.markdown-body .pl-ba{color:#586069}.markdown-body .pl-sg{color:#959da5}.markdown-body .pl-corl{text-decoration:underline;color:#032f62}.markdown-body .mb-0{margin-bottom:0!important}.markdown-body .my-2{margin-bottom:8px!important;margin-top:8px!important}.markdown-body .pl-0{padding-left:0!important}.markdown-body .py-0{padding-top:0!important;padding-bottom:0!important}.markdown-body .pl-1{padding-left:4px!important}.markdown-body .pl-2{padding-left:8px!important}.markdown-body .py-2{padding-top:8px!important;padding-bottom:8px!important}.markdown-body .pl-3{padding-left:16px!important}.markdown-body .pl-4{padding-left:24px!important}.markdown-body .pl-5{padding-left:32px!important}.markdown-body .pl-6{padding-left:40px!important}.markdown-body .pl-7{padding-left:48px!important}.markdown-body .pl-8{padding-left:64px!important}.markdown-body .pl-9{padding-left:80px!important}.markdown-body .pl-10{padding-left:96px!important}.markdown-body .pl-11{padding-left:112px!important}.markdown-body .pl-12{padding-left:128px!important}.markdown-body hr{border-bottom-color:#eee}.markdown-body kbd{display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0}.markdown-body blockquote{padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eaecef}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#6a737d}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li{word-wrap:break-all}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto}.markdown-body table th{font-weight:600}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #dfe2e5}.markdown-body table tr{background-color:#fff;border-top:1px solid #c6cbd1}.markdown-body table tr:nth-child(2n){background-color:#f6f8fa}.markdown-body img{max-width:100%;box-sizing:initial;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body code{padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px}.markdown-body pre code{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0}.markdown-body .commit-tease-sha{display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56}.markdown-body .full-commit .btn-outline:not(:disabled):hover{color:#005cc5;border-color:#005cc5}.markdown-body .blob-wrapper{overflow-x:auto;overflow-y:hidden}.markdown-body .blob-wrapper-embedded{max-height:240px;overflow-y:auto}.markdown-body .blob-num{width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-ms-user-select:none;user-select:none}.markdown-body .blob-num:hover{color:rgba(27,31,35,.6)}.markdown-body .blob-num:before{content:attr(data-line-number)}.markdown-body .blob-code{position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top}.markdown-body .blob-code-inner{overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre}.markdown-body .pl-token.active,.markdown-body .pl-token:hover{cursor:pointer;background:#ffea7f}.markdown-body .tab-size[data-tab-size="1"]{-moz-tab-size:1;-o-tab-size:1;tab-size:1}.markdown-body .tab-size[data-tab-size="2"]{-moz-tab-size:2;-o-tab-size:2;tab-size:2}.markdown-body .tab-size[data-tab-size="3"]{-moz-tab-size:3;-o-tab-size:3;tab-size:3}.markdown-body .tab-size[data-tab-size="4"]{-moz-tab-size:4;-o-tab-size:4;tab-size:4}.markdown-body .tab-size[data-tab-size="5"]{-moz-tab-size:5;-o-tab-size:5;tab-size:5}.markdown-body .tab-size[data-tab-size="6"]{-moz-tab-size:6;-o-tab-size:6;tab-size:6}.markdown-body .tab-size[data-tab-size="7"]{-moz-tab-size:7;-o-tab-size:7;tab-size:7}.markdown-body .tab-size[data-tab-size="8"]{-moz-tab-size:8;-o-tab-size:8;tab-size:8}.markdown-body .tab-size[data-tab-size="9"]{-moz-tab-size:9;-o-tab-size:9;tab-size:9}.markdown-body .tab-size[data-tab-size="10"]{-moz-tab-size:10;-o-tab-size:10;tab-size:10}.markdown-body .tab-size[data-tab-size="11"]{-moz-tab-size:11;-o-tab-size:11;tab-size:11}.markdown-body .tab-size[data-tab-size="12"]{-moz-tab-size:12;-o-tab-size:12;tab-size:12}.markdown-body .task-list-item{list-style-type:none}.markdown-body .task-list-item+.task-list-item{margin-top:3px}.markdown-body .task-list-item input{margin:0 .2em .25em -1.6em;vertical-align:middle}</style><meta name="generator" content="Gatsby 2.23.4"/><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="canonical" href="https://jeffrafter.com/working-with-github-actions/" data-baseprotocol="https:" data-basehost="jeffrafter.com"/><link rel="icon" href="/favicon-32x32.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=bddcaef8d466d0f77d76d3d885709d8f"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><title data-react-helmet="true">Working with GitHub Actions | Jeff Rafter</title><meta data-react-helmet="true" name="description" content="GitHub Actions are still in beta and are changing quickly. But if you are looking to get started the possibilities are endless."/><meta data-react-helmet="true" property="og:title" content="Working with GitHub Actions"/><meta data-react-helmet="true" property="og:description" content="GitHub Actions are still in beta and are changing quickly. But if you are looking to get started the possibilities are endless."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:image" content="https://jeffrafter.com//static/b3f301cf766c1545df5fa5a1dfeda413/10e03/hubot.png"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="Jeff Rafter"/><meta data-react-helmet="true" name="twitter:title" content="Working with GitHub Actions"/><meta data-react-helmet="true" name="twitter:description" content="GitHub Actions are still in beta and are changing quickly. But if you are looking to get started the possibilities are endless."/><meta data-react-helmet="true" name="keywords" content="typescript, github, actions"/><style data-styled="coseIW ddlDEo bOnSNx gXLbcD aCPwf" data-styled-version="4.4.1">
/* sc-component-id: sc-global-3268680936 */
::selection{background-color:#dad9d9;color:rgba(0,0,0,0.70);}
/* sc-component-id: sc-bdVaJa */
.coseIW ul{list-style-type:none;margin:1rem 0;padding:0;margin-left:-16px;} .coseIW li{display:inline-block;margin:16px;} .coseIW li a{background:none;}
/* sc-component-id: sc-bwzfXH */
.aCPwf{padding-bottom:36px;}
/* sc-component-id: sc-ifAKCX */
.ddlDEo{width:55%;}
/* sc-component-id: sc-gzVnrw */
.bOnSNx{margin-top:40px;margin-bottom:40px;float:right;}
/* sc-component-id: sc-htoDjs */
.gXLbcD{list-style-type:none;} .gXLbcD li::before{content:'' !important;padding-right:0 !important;}</style><link as="script" rel="preload" href="/webpack-runtime-9d81d0198458e5aa5952.js"/><link as="script" rel="preload" href="/framework-95b680cb3190aa9bfe59.js"/><link as="script" rel="preload" href="/styles-24c541b6ac347bae38f1.js"/><link as="script" rel="preload" href="/app-51d0929071629bddce45.js"/><link as="script" rel="preload" href="/commons-6458b952aa116f5f11f8.js"/><link as="script" rel="preload" href="/109cf451cc5d7f6d2abc8e688d09142e78350594-53a6b222a8910dfb5d1b.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-7133ab7322325c379163.js"/><link as="fetch" rel="preload" href="/page-data/working-with-github-actions/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><nav class="sc-bdVaJa coseIW navigation"><ul><li><a href="/">&amp;</a></li><li><a href="/tags">Tags</a></li><li><a href="/about">About</a></li></ul></nav><main class="content" role="main"><article><header><h1>Working with GitHub Actions</h1><p>September 19, 2019</p></header><div class="page-content"><div><section><figure><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 896px; "
    >
      <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 100%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsSAAALEgHS3X78AAAENElEQVQ4y5VUa0yTVxj+ym1sLls0YX/8uc1k249NWcQBk1vE/nBzccyI+M8sM27TYbJlGOdiYix3GLLB1MplDBiNrBehyMW1lJWxKiLQG7PIpfZC+7VfW2n5+n3tu3NOxTguP3aSk/d6nvO+73nfQwUCAWrtoj3e/8gV5hA15uHiMC+xsvUDDED7bIBHm1N6AWS2sALbVEvheHIAgcb5fP7n/X7/S27a+xwBpb2Uy+0h9nIECACE73VyMskjDkpUFv5TxRTX+YiHARffi21TPp5cSiGwbQhUxzC+5SUXPbga2cr9BgEnz0+IdmckqM0TiVindPLlGOSsepa7NLbIDfkBeuxhJbZNrwKG2VASAjVFURgI0E4/jsRTm6xbrkhNl5WDk70GtvRvKytfQoCOWMpPAV00s8Xlpl0sy4LbTTvpuXvJWA/QmgKqvBL4471vwFOUQiJ0sNUjPMA1sx9qJt0gpwEU9rDhmNbz4tNbXU77FrfHJx66YwWdmSbhA1uYrGk+MdZXdwgkFYegp0Kowvr2BbYWgZapfbB/bBk+6ndHP+5cWEnHtofBCCpy+2UBFi7soJLbWloZadtP3xFAeU6atDQfvjxRwJ87cxhuV+VF7v5+MufMIry5USkAxmNMVPo+qRcnyzsM/Vlgbc5gSHucS01xtKaDujwzMCjKdCxc3xMyNu7JwDatpiVRagvHS21svAztrkU27kkNUct0ZREhKMkSsvJ9YKrfOQU9Bz7gZbkjpiuZjaKvDhzsFWXXGRszg3RH1ty46LVPsP9fncfjNny1m9+/TSU86bE6paJZNDBSbrhzXcfK8gdgcv+rsy3CUs1lIfTVfghLv2ZBXf0p58EReAH7l7VfEegGy9aDXtOOktuqALZXL8APlTMrR+DGG9tDMuFZ6N4N8yOVcM+s451N7/Ltfc13L9nhKPavsUTiYC3YcFkqoRJVt+BZPSfN+SIqz4XIjTRgtKKI36yIOJrSosquksKLNhCRQP5UCTZMu/bBCqFN+lmBUX2RTAQvzb4Jw/moybJZvjsjAvJ0sLVksK6OnAa7oojR/7z3a9IqLXnra1mGZnV1eX/LJq8e6NpbiF6ctlxNB6M4D6av5gTUpalitjtbjRodTD/ukmM/m3jXplOFWic3Norj50kqlQVbX27TanXn9QwUD02exrpR8bHPRqXV0N/8bQ2W+zoqNweMNWgRoVVaFUm94D5UfG4EkHhgB5ZPS0Jbe7UzeqXOQRyV2pn1KevnY//fP3YfNdwvIV+VyBgkjiKD70iDJWha9bVM3ErSaG6/0i/7JTnW5IOUYd67MSCm0/MegWHBKxCbAgTwgj741qmJ5eOYVzx8nPDsOe3Eg9i5OS+1aZT/d03OujcHQzRpet77OkphJ+KFpkWmGO3KqTlPBaJVZitTPD3n2Yfs7yCK/RLXBvMv9zWbegCYqKMAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Hubot from the Octodex"
        title="Hubot from the Octodex"
        src="/static/b3f301cf766c1545df5fa5a1dfeda413/4c42d/hubot.png"
        srcset="/static/b3f301cf766c1545df5fa5a1dfeda413/72799/hubot.png 320w,
/static/b3f301cf766c1545df5fa5a1dfeda413/6af66/hubot.png 640w,
/static/b3f301cf766c1545df5fa5a1dfeda413/4c42d/hubot.png 896w"
        sizes="(max-width: 896px) 100vw, 896px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
    </span></figure><figcaption>
Image credit: GitHub's Hubot <a href="https://octodex.github.com/hubot/">from the Octodex</a>
</figcaption><p>GitHub Actions are still in beta and are changing quickly. But if you are looking to get started the possibilities are endless. This guide is mostly about pointing to documentation and exploring some fun ways to use GitHub Actions.</p><p>In this post we’ll create a repository which contains a GitHub Action - built in TypeScript - and an associated workflow. In the action we’ll respond to push events and output some logging information. Technically, you don’t need a custom script to accomplish this; you could instead build a very simple workflow which runs <code class="language-text">echo</code> commands. Using a full script will allow us to explore more capabilities of GitHub Actions. We’ll also create an action that automatically responds to, and reacts to, issue comments.</p><p>Before you read this it is important to note: starting with a <a href="https://github.com/actions/javascript-template">template</a> will save you a lot of time and setup. In this post, however, I am going to work through and explain all of the steps. Included in this post are some of the reasons I’ve chosen one particular setup and skipped another. When getting started with GitHub Actions it is difficult to understand how all of the pieces fit together, or why you might want to create and action for a particular task. Hopefully this post provides some helpful examples. That said, there are probably steps here that you’ve seen before, don’t care about, or just want to skip and that’s okay.</p><p>In order to follow this, you’ll need a GitHub account. Additionally, you’ll need to <a href="https://github.com/features/actions">sign up for the GitHub Actions beta</a>. The examples will be in TypeScript.</p><blockquote>
<p>All of the code (and commits) are availble on GitHub: <a href="https://github.com/jeffrafter/example-github-action-typescript">https://github.com/jeffrafter/example-github-action-typescript</a></p>
</blockquote><h1 id="documentation" style="position:relative;"><a href="#documentation" aria-label="documentation permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Documentation</h1><p>The documentation for GitHub Actions is really good (far more complete than this post) and is good to have on hand. You can learn how to build Actions, Workflows and core concepts; as well as dive deeply on using the toolkit, octokit and handling payloads.</p><ul>
<li><a href="https://help.github.com/en/categories/automating-your-workflow-with-github-actions">Automating your Workflow with GitHub Actions</a></li>
<li><a href="https://github.com/actions/toolkit/blob/master/docs/github-package.md">GitHub Package Toolkit</a></li>
<li><a href="https://developer.github.com/v3/activity/events/types/">Event Types &#x26; Payloads</a></li>
<li><a href="https://developer.github.com/v3/">Rest API V3</a></li>
<li><a href="https://octokit.github.io/rest.js/">octokit/rest.js</a></li>
</ul><h1 id="getting-started" style="position:relative;"><a href="#getting-started" aria-label="getting started permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Getting started</h1><p>First you want to create a folder for your project:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">mkdir</span> example-github-action-typescript
<span class="token builtin class-name">cd</span> example-github-action-typescript</code></pre></div><p>We’ll be using TypeScript to build our action, which requires Node. Out of the box GitHub supports a few environments for your actions to run <label for="sd-there-are-several" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-there-are-several" class="margin-toggle" /><span class="sidenote">There are several different <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#supported-virtual-environments-and-hardware-resources">virtual operating systems</a> you can use for your actions which come preloaded with <a href="https://help.github.com/en/articles/software-in-virtual-environments-for-github-actions">useful software</a>. Additionally, you can utilize Docker containers running in one of these virtual environments to pre-configure your hosts.</span>. There is built-in support for running actions built in JavaScript (using Node). So why did I choose to use TypeScript? It makes development a lot easier by providing compile-time checks and hints in my editor about methods and parameters (especially if you are using an editor like VSCode that has support for it). As part of our action we’ll export the TypeScript to JavaScript.</p><p>Let’s setup our example to use Node. If you have multiple local projects you might run into a conflict about which Node version should be used. Node Version Manager solves this problem. To control which version of Node should be used in your project, add an <code class="language-text">.nvmrc</code><label for="sd-notice-that-the-less" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-notice-that-the-less" class="margin-toggle" /><span class="sidenote">Notice that the <code>.nvmrc</code> file starts with a "<code>.</code>" (period). By default on most systems this creates a hidden file. Oftentimes general project config is hidden away. On MacOS you can show hidden files in Finder by running <code>defaults write com.apple.finder AppleShowAllFiles -bool true</code> and restarting Finder. If you want to list hidden files in your console use the <code>-a</code> parameter: <code>ls -a</code>.</span> file:</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token number">12.7</span>.<span class="token number">0</span></code></pre></div><p>The file is pretty simple; just the version. I chose 12.7.0 because it matches the version that is used to run our action (<code class="language-text">node12</code>). Node 10.16.3 is installed in the default <a href="https://help.github.com/en/articles/software-in-virtual-environments-for-github-actions">GitHub Action software environment</a> and can be used as well but the will not match the running action environment. At the time you read this there may be a newer version of Node or you may chose to use an older version because your code requirements. You can check <a href="https://nodejs.org">https://nodejs.org</a>.</p></section>
<section><h2 id="ignore-some-things" style="position:relative;"><a href="#ignore-some-things" aria-label="ignore some things permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ignore some things</h2><p>We plan to use <code class="language-text">git</code> to keep track of our changes. As we work on our project locally, there will be a lot of files we won’t want to keep track of; we’ll want to ignore them. To do this we’ll create a new file called <code class="language-text">.gitignore</code> <label for="sd-less-than-code" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-less-than-code" class="margin-toggle" /><span class="sidenote"><code>.gitignore</code> also starts with a "<code>.</code>" and you can start to see a pattern emerge.</span>. These files can be very short and specific, or they can be very long and general. We’ll use a more generic one that will work on different kinds of computers. If you are looking for an example <code class="language-text">.gitignore</code> you can check out <a href="https://github.com/github/gitignore">https://github.com/github/gitignore</a>. For now, just copy the following (this <code class="language-text">.gitignore</code> includes only what is important for this post. For a more complete version see <a href="https://github.com/jeffrafter/example-github-action-typescript/blob/master/.gitignore">here</a>):</p><div class="gatsby-highlight" data-language=".gitignore"><pre class="language-.gitignore"><code class="language-.gitignore"># Ignore any generated TypeScript -&gt; JavaScript files
.github/actions/**/*.js

# Logs
logs
*.log
npm-debug.log*

# Dependency directories
node_modules/

# Typescript v1 declaration files
typings/

# Optional npm cache directory
.npm

# Optional eslint cache
.eslintcache</code></pre></div><p>With this setup we’ll ignore <code class="language-text">node_modules</code> and JavaScript files in our action folders (if there was any generated locally). This is a non-standard choice but makes developing our action a little easier. By default, GitHub recommends you include the <code class="language-text">node_modules</code> folder as installing them per-action execution is slow (25-35 seconds). Including all of the <code class="language-text">node_modules</code> in your repository can lead to a lot of files and large commits which can be confusing. Additionally, if your <code class="language-text">node_modules</code> include platform specific dependencies which must be compiled (such as <code class="language-text">hunspell</code>) you will need to recompile them for the target action container anyway.</p><p>Ignoring generated JavaScript in our action folders means that we have to build our TypeScript as part of our workflow. Again, this is slower and can lead to compile time errors on the server, but it saves us a few steps when developing actions.</p></section>
<section><h2 id="save-your-progress-using-version-control" style="position:relative;"><a href="#save-your-progress-using-version-control" aria-label="save your progress using version control permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Save your progress using version control</h2><p>At this point we really haven’t made anything (except a lot of configuration). Even though our website isn’t even a website yet – it still makes sense to save our work. If we make a mistake having our code saved will help us. To do this we’ll use <code class="language-text">git</code> - a version control software that lets us create commits or <em>versions</em> as we go. To initialize a <code class="language-text">git</code> repository run:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> init</code></pre></div><p>By default this creates an empty git repository (none of our files have been added to it). Generally, I use <a href="https://desktop.github.com/">GitHub Desktop</a>; however, I’ll use the command line here. You can check the status of your changes and repository:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master

No commits yet

Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	.gitignore
	.nvmrc

nothing added to commit but untracked files present <span class="token punctuation">(</span>use <span class="token string">"git add"</span> to track<span class="token punctuation">)</span></code></pre></div><p>Let’s get ready to create a commit by adding all of the files:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>Here the <code class="language-text">.</code> means: “everything in the current folder”. But what are we adding it to? We are adding it to the commit <em>stage</em>. Let’s check the status again:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master

No commits yet

Changes to be committed:
  <span class="token punctuation">(</span>use <span class="token string">"git rm --cached &lt;file>..."</span> to unstage<span class="token punctuation">)</span>

	new file:   .gitignore
	new file:   .nvmrc</code></pre></div><p>We’re getting ready to add two new files to our repository. Let’s commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Initial commit with configuration"</span></code></pre></div><p>This creates a commit with the message we specified. The commit acts like a save point. If we add or delete files or change something and make a mistake, we can always revert back to this point. We’ll continue to commit as we make changes.</p></section>
<section><h2 id="packages--dependencies" style="position:relative;"><a href="#packages--dependencies" aria-label="packages  dependencies permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Packages &#x26; Dependencies</h2><p>For almost any Node project you’ll find that you use a lot of packages – you’ll have far more code in packages in your <code class="language-text">node_modules</code> folder (where package code is stored) than your main project.</p><p>Initialize your packages:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> init -y</code></pre></div><p>Now you have a <code class="language-text">package.json</code>:</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"example-github-action-typescript"</span><span class="token punctuation">,</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token property">"main"</span><span class="token operator">:</span> <span class="token string">"index.js"</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"keywords"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"author"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span>
<span class="token punctuation">}</span></code></pre></div><p>Let’s simplify it a bit (you can fill out or keep fields you like here, but this is the minimum):</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"private"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">"scripts"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"build"</span><span class="token operator">:</span> <span class="token string">"tsc"</span><span class="token punctuation">,</span>
    <span class="token property">"test"</span><span class="token operator">:</span> <span class="token string">"tsc --noEmit &amp;&amp; jest"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"license"</span><span class="token operator">:</span> <span class="token string">"ISC"</span>
<span class="token punctuation">}</span></code></pre></div><p>The only scripts we need at the moment are <code class="language-text">build</code> which will convert our TypeScript to JavaScript and <code class="language-text">test</code> which will run our tests. While we’re working on our action we’ll need access to all of our project’s dependencies; the difference between <code class="language-text">dependencies</code> and <code class="language-text">devDependencies</code> won’t matter very much. For that reason we’ll install everything as a <code class="language-text">dev</code> dependency:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">\</span>
  @actions/core <span class="token punctuation">\</span>
  @actions/github</code></pre></div><p>The <code class="language-text">@actions/core</code> and <code class="language-text">@actions/github</code> are the baseline for interacting with GitHub and the incoming events. When you publish an action which is meant to be used by multiple repositories and workflows, you’ll release the action with dependencies included (so they run more quickly). In that case you would use <code class="language-text">--save</code> instead of <code class="language-text">--save-dev</code>. In most other cases the code for your actions should only be used as part of your testing or development environment (not part of your production environment).</p><p>We’ll want to add testing support to test our action:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">\</span>
  jest <span class="token punctuation">\</span>
  js-yaml</code></pre></div><p>And TypeScript support:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">\</span>
  typescript <span class="token punctuation">\</span>
  ts-jest</code></pre></div><p>Finally, because we’re using TypeScript, we’ll want to add type support for development:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">\</span>
  @types/jest <span class="token punctuation">\</span>
  @types/node</code></pre></div><p>This is a good opportunity to create another commit; check the status:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	package-lock.json
	package.json

nothing added to commit but untracked files present <span class="token punctuation">(</span>use <span class="token string">"git add"</span> to track<span class="token punctuation">)</span></code></pre></div><p>We’ve added a lot of files to our folder but many of them are ignored. For example, the <code class="language-text">node_modules</code> folder contains tons of files (as mentioned before). We want everyone working on our project to install the same dependencies. When installing, they were automatically added to the <code class="language-text">package.json</code> file. The <code class="language-text">package-lock.json</code> ensures that the dependencies of our packages are locked to specific versions. Because of this, we’ll add both of these files to <code class="language-text">git</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And then commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Setting up our packages"</span></code></pre></div></section>
<section><h2 id="typescript" style="position:relative;"><a href="#typescript" aria-label="typescript permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>TypeScript</h2><p>We’ll also need to configure TypeScript before we can build our action. Create <code class="language-text">tsconfig.json</code>:</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"compilerOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"module"</span><span class="token operator">:</span> <span class="token string">"commonjs"</span><span class="token punctuation">,</span>
    <span class="token property">"target"</span><span class="token operator">:</span> <span class="token string">"esnext"</span><span class="token punctuation">,</span>
    <span class="token property">"lib"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"es2015"</span><span class="token punctuation">,</span> <span class="token string">"es2017"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">"strict"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"esModuleInterop"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"skipLibCheck"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noUnusedLocals"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noUnusedParameters"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"noImplicitAny"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"removeComments"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token property">"preserveConstEnums"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"include"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">".github/actions/**/*.ts"</span><span class="token punctuation">,</span> <span class="token string">"**/*.ts"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"exclude"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"node_modules"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span></code></pre></div><p>By default this allows us to build all of the actions contained in our repository, adds some strict compile-time checks, and skips type checking for our dependencies.</p><p>Let’s commit this file:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	tsconfig.json

nothing added to commit but untracked files present <span class="token punctuation">(</span>use <span class="token string">"git add"</span> to track<span class="token punctuation">)</span></code></pre></div><p>Add it:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"TypeScript configuration"</span></code></pre></div><h1 id="keep-it-clean-optional" style="position:relative;"><a href="#keep-it-clean-optional" aria-label="keep it clean optional permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Keep it clean (optional)</h1><blockquote>
<p>Note: this section is not required to complete this tutorial; if you want to skip it feel free.</p>
</blockquote><p>Everyone has different preferences when they edit code. Some prefer tabs over spaces. Some want two spaces instead of four. Some prefer semicolons and some don’t. It shouldn’t matter right? But it does. If editors are autoformatting code based on user preferences it is important to make sure everyone has chosen the same set of defaults for that autoformatting. This makes it easy to tell what changed between versions – even when different developers (with different preferences) have made changes.</p><p>For this reason we’ll setup a linter and code formatter for our code. Install <a href="https://eslint.org/">eslint</a> and <a href="https://prettier.io/">prettier</a>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev <span class="token punctuation">\</span>
  eslint <span class="token punctuation">\</span>
  @typescript-eslint/eslint-plugin <span class="token punctuation">\</span>
  @typescript-eslint/parser <span class="token punctuation">\</span>
  eslint-config-prettier <span class="token punctuation">\</span>
  eslint-plugin-prettier <span class="token punctuation">\</span>
  prettier</code></pre></div><p>Now that we have the packages we’ll need to configure them in <code class="language-text">.eslintrc.json</code>:</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"parser"</span><span class="token operator">:</span> <span class="token string">"@typescript-eslint/parser"</span><span class="token punctuation">,</span>
  <span class="token property">"plugins"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"@typescript-eslint"</span><span class="token punctuation">,</span> <span class="token string">"prettier"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"extends"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">"eslint:recommended"</span><span class="token punctuation">,</span>
    <span class="token string">"plugin:@typescript-eslint/recommended"</span><span class="token punctuation">,</span>
    <span class="token string">"plugin:prettier/recommended"</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"rules"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"prettier/prettier"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">"error"</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token property">"singleQuote"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token property">"trailingComma"</span><span class="token operator">:</span> <span class="token string">"all"</span><span class="token punctuation">,</span>
        <span class="token property">"bracketSpacing"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        <span class="token property">"printWidth"</span><span class="token operator">:</span> <span class="token number">120</span><span class="token punctuation">,</span>
        <span class="token property">"tabWidth"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token property">"semi"</span><span class="token operator">:</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token comment">// octokit/rest requires parameters that are not in camelcase</span>
    <span class="token property">"camelcase"</span><span class="token operator">:</span> <span class="token string">"off"</span><span class="token punctuation">,</span>
    <span class="token property">"@typescript-eslint/camelcase"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token property">"properties"</span><span class="token operator">:</span> <span class="token string">"never"</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"env"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"node"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"jest"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token property">"es6"</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"parserOptions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"ecmaVersion"</span><span class="token operator">:</span> <span class="token number">2018</span><span class="token punctuation">,</span>
    <span class="token property">"sourceType"</span><span class="token operator">:</span> <span class="token string">"module"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>I won’t go into too much detail here; there are <a href="https://www.robertcooper.me/using-eslint-and-prettier-in-a-typescript-project">better explanations</a> to be found. This configuration does a few things:</p><ul>
<li>Relies on the typescript eslint parser with the prettier plugin - I’ve found this works very well in @Code. If you were previously using <code class="language-text">ts-lint</code> with prettier this setup should replace your old configuration.</li>
<li>This eslint config doesn’t work perfectly for projects that contain both JavaScript and TypeScript - because of that we won’t attempt to lint JavaScript files in our project</li>
<li>I’ve turned off the camelcase rules for properties - when writing GitHub Actions you will likely use properties from <code class="language-text">@actions/github</code> and from the API and these will not be camelcase.<label for="sd-there-are-lots-of" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-there-are-lots-of" class="margin-toggle" /><span class="sidenote">There are lots of ways to name variables including <code>camelCase</code>, <code>snake_case</code>, <code>ProperCase</code>, and <code>CONSTANT_CASE</code>. JavaScript and TypeScript tend to use <code>camelCase</code> for variable names, but Ruby (which is what much of GitHub and the GitHub API is written in) generally uses <code>snake_case</code>. This is one of those places where the idioms of different languages collide and you have to make the best of it.</span></li>
<li>The expected environment should include <code class="language-text">node</code> and <code class="language-text">jest</code> - this will help <code class="language-text">eslint</code> ignore missing declarations for things like <code class="language-text">describe</code>, <code class="language-text">process</code>, <code class="language-text">module</code>, etc.</li>
</ul><p>If you need to ignore specific files when linting you can add them to <code class="language-text">.eslintignore</code>. Because our setup doesn’t work well for JavaScript we’ll ignore all JavaScript files in <code class="language-text">.eslintignore</code>:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">*.js
!/.github</code></pre></div><p>Notice that we are explicitly unignoring the <code class="language-text">.github</code> folder. This is where our source code will be kept (see next section). We have to unignore this folder explicitly because it starts with a <code class="language-text">.</code> and is normally ignored by eslint.</p><p>Add a <code class="language-text">lint</code> action to the <code class="language-text">scripts</code> node in <code class="language-text">package.json</code>:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;tsc&quot;,
    &quot;test&quot;: &quot;tsc --noEmit &amp;&amp; jest&quot;,
    &quot;lint&quot;: &quot;eslint . --ext .ts&quot;
  },</code></pre></div><p>With this in place we can run:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run lint</code></pre></div><p>Wait, there’s an error:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">Oops! Something went wrong! :(

ESLint: 6.4.0.

No files matching the pattern &quot;.&quot; were found.
Please check for typing mistakes in the pattern.</code></pre></div><p>We haven’t written any TypeScript to lint yet. Time to stop configuring and start writing code.</p><p>Checking our <code class="language-text">git status</code> should show our changes:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   package-lock.json
	modified:   package.json

Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	.eslintignore
	.eslintrc.json

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>This makes sense; we’ve added two files and installed some new <code class="language-text">devDependencies</code> into our packages. Let’s add everything and to the commit stage:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>If we check <code class="language-text">git status</code> again:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Changes to be committed:
  <span class="token punctuation">(</span>use <span class="token string">"git reset HEAD &lt;file>..."</span> to unstage<span class="token punctuation">)</span>

	new file:   .eslintignore
	new file:   .eslintrc.json
	modified:   package-lock.json
	modified:   package.json</code></pre></div><p>Let’s commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Linting configuration"</span></code></pre></div></section>
<section><h2 id="project-layout" style="position:relative;"><a href="#project-layout" aria-label="project layout permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Project Layout</h2><p>The code for GitHub Actions are generally kept in the <code class="language-text">actions</code> folder in the <code class="language-text">.github</code> folder. By default, the <code class="language-text">.github</code> folder contains metadata for the repository that can be used for automated tasks. The steps for running an action are defined in a Workflow which is usually stored in the <code class="language-text">workflows</code> folder in the <code class="language-text">.github</code> folder:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.github/
  actions/
    debug-action/
      __tests__/
        debug.test.ts
      action.yml
      debug.js
      debug.ts
  workflows/
    debug-workflow.yml</code></pre></div><p>Repositories can contain multiple actions (or none at all); we’ll define our debug action inside a folder called <code class="language-text">debug-action</code>. This will contain our TypeScript, generated JavaScript, tests, and the <code class="language-text">action.yml</code> where all of the settings for the action are kept.</p><p>A repository may also have multiple workflows (or none at all); we’ll setup a workflow that runs our debug action inside <code class="language-text">debug-workflow.yml</code>.</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">mkdir</span> -p .github/actions
<span class="token function">mkdir</span> -p .github/actions/debug-action
<span class="token function">mkdir</span> -p .github/actions/debug-action/__tests__
<span class="token function">mkdir</span> -p .github/workflows</code></pre></div></section>
<section><h2 id="building-the-debug-action" style="position:relative;"><a href="#building-the-debug-action" aria-label="building the debug action permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Building the debug action</h2><p>Enough setup; let’s get building. Create a new file called <code class="language-text">.github/actions/debug-action/debug.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// Action code here</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>The code inside your action should be auto-executing. In this case we define a <code class="language-text">run</code><label for="sd-we-ve-named-our" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-we-ve-named-our" class="margin-toggle" /><span class="sidenote">We've named our function <code>run</code> but you could name the function anything you wanted. <code>run</code> is a convention used in the base <a href="https://github.com/actions/javascript-template/blob/master/src/main.ts"><code>javascript-template</code></a></span> method and then immediately call it right after it has been defined. In fact, you don’t even need to define a method, you could include the code for your action directly. In some cases that might be okay, but as the complexity of the action increases it would become confusing. We’ve also made our function the default export. This isn’t required but will make things easier as we move forward and test our code.</p><p>There are lots of helpers built into the <code class="language-text">core</code> package we imported. This is the simplest. Because we’re using TypeScript you may see autocomplete information in your editor:<label for="sd-i-m-using-vscode" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-i-m-using-vscode" class="margin-toggle" /><span class="sidenote">I'm using VSCode here with the <a href="https://yoncetheme.com/">Yoncé theme</a>. It is super rad.</span></p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1280px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b2d2c02c2a36d9a9d32c350efffc7555/e2d3b/action-core-autocomplete.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.12500000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABaklEQVQoz43RW2vbMBQHcH+JMYgd2boe6Rw5imzHpU7a5tJmexqMQd8KG6zL9rYv0O9eOdkNytoefgh0pL8QUtYzoxnXTKCxRhlfSLSSvPAkiLhWVT4p/lfZG9BCCFOU3BTSFUJOkPHIlOVGCzeVouLjvvyJMTzv6vM2Dmi72vYz7Mj2iCvyPVHrKZILDkg/YQCUycppLks+tPUK44WLFiwzKimPqtMIIw76jzS1UmdQTVHwH2efHtoPP+P+c1h/Cev7+fYQdt/C9nvYnRzC9msYm/dhm/qH5uYaYmZYiZX82O3vwtVtvXzv+w0119T+1v3jV3OXRr84U5TNmKJKd/NhwHm0hGAV6NOFn5E2gFDZ23zCWbWMl3vfp1P31K2xcWAtwPNImqzIczmGL3a0uMLorXPHtRdrDOfH8BBXN74fXKgtwuvqb3jZXKY3eEeLAYMGk37xRTiGi1ywajUbNq7Z2JjUxr6GF/oR2LZ4ARq4G6gAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="A popup showing the available methods for the core object"
        title="A popup showing the available methods for the core object"
        src="/static/b2d2c02c2a36d9a9d32c350efffc7555/21b4d/action-core-autocomplete.png"
        srcset="/static/b2d2c02c2a36d9a9d32c350efffc7555/72799/action-core-autocomplete.png 320w,
/static/b2d2c02c2a36d9a9d32c350efffc7555/6af66/action-core-autocomplete.png 640w,
/static/b2d2c02c2a36d9a9d32c350efffc7555/21b4d/action-core-autocomplete.png 1280w,
/static/b2d2c02c2a36d9a9d32c350efffc7555/e2d3b/action-core-autocomplete.png 1466w"
        sizes="(max-width: 1280px) 100vw, 1280px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>At this point the action does nothing. Lets add some debugging:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div><p>Even though this action isn’t accomplishing much, let’s write a test for it.</p><h3 id="testing-the-debug-action" style="position:relative;"><a href="#testing-the-debug-action" aria-label="testing the debug action permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testing the debug action</h3><p>Create a new file called <code class="language-text">.github/actions/debug-action/__tests__/debug.test.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> run <span class="token keyword">from</span> <span class="token string">'../debug'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'debug action debug messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'outputs a debug message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> debugMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>We import the actions core library and the run method we just created in our debug action. In our test we create a Jest spy which allows us to verify that the <code class="language-text">core.debug</code> method is getting called with the correct parameters. Normally, I wouldn’t test the debug output (if it fails I don’t care too much) but this is a good foundation.</p><p>In order to run this we’ll need to configure Jest. Create a new file called <code class="language-text">jest.config.js</code> in the root of your project:</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js">module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  clearMocks<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testEnvironment<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
  testMatch<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/*.test.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^.+\\.ts$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  transformIgnorePatterns<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'^.+\\.js$'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  verbose<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div><p>At this point you can run the tests. From your terminal run:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run <span class="token builtin class-name">test</span></code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">&gt; @ test /Users/njero/Code/Examples/example-github-action-typescript
&gt; tsc --noEmit &amp;&amp; jest

 PASS  .github/actions/debug-action/__tests__/debug.test.ts
  debug action debug messages
    ✓ outputs a debug message (5ms)

::debug::👋 Hello! You are an amazing person! 🙌
::debug::👋 Hello! You are an amazing person! 🙌
Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
Time:        1.423s
Ran all test suites.</code></pre></div><p>It should pass.<label for="sd-the-debug-output" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-the-debug-output" class="margin-toggle" /><span class="sidenote">The debug output here is a little verbose. There's an <a href="https://github.com/actions/toolkit/issues/118">open issue</a> to be able to silence this while running tests.</span> But let’s remove the debug information from the test output. Change <code class="language-text">jest.config.js</code> so that it doesn’t output the debug lines:</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token keyword">const</span> processStdoutWrite <span class="token operator">=</span> process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>stdout<span class="token punctuation">)</span>
process<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token function-variable function">write</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> encoding<span class="token punctuation">,</span> cb</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>str<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex">/^::debug::/</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">processStdoutWrite</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> encoding<span class="token punctuation">,</span> cb<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  clearMocks<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  moduleFileExtensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'js'</span><span class="token punctuation">,</span> <span class="token string">'ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  testEnvironment<span class="token operator">:</span> <span class="token string">'node'</span><span class="token punctuation">,</span>
  testMatch<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'**/*.test.ts'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  transform<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'^.+\\.ts$'</span><span class="token operator">:</span> <span class="token string">'ts-jest'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  verbose<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span></code></pre></div><p>With that change the debug output should no longer appear when we run the tests. We can run our <code class="language-text">lint</code> task to verify that our code is clean:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run lint</code></pre></div><p>It should succeed this time with no errors and no warnings. Let’s commit what we have. Run <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	.github/
	jest.config.js

nothing added to commit but untracked files present <span class="token punctuation">(</span>use <span class="token string">"git add"</span> to track<span class="token punctuation">)</span></code></pre></div><p>Let’s add those files:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>Note, one of the items listed was the <code class="language-text">.github</code> folder. When we added it all of the newly added files inside of that folder were also added. Let’s check the status again:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>Notice that we are about to commit three files:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Changes to be committed:
  <span class="token punctuation">(</span>use <span class="token string">"git reset HEAD &lt;file>..."</span> to unstage<span class="token punctuation">)</span>

	new file:   .github/actions/debug-action/__tests__/debug.test.ts
	new file:   .github/actions/debug-action/debug.ts
	new file:   jest.config.js</code></pre></div><p>Commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Debug action"</span></code></pre></div><h3 id="create-the-actionyml-for-the-debug-action" style="position:relative;"><a href="#create-the-actionyml-for-the-debug-action" aria-label="create the actionyml for the debug action permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Create the action.yml for the debug action</h3><p>We’ve written the code for our action and a test that tells us it is working. Unfortunately we haven’t defined how our action should be used. To do that we have to configure the action in a <code class="language-text">yml</code> file. Create <code class="language-text">.github/actions/debug-action/action.yml</code>:</p><div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'debug-action'</span>
<span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">'Outputs debug information'</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> <span class="token string">'jeffrafter'</span>
<span class="token key atrule">runs</span><span class="token punctuation">:</span>
  <span class="token key atrule">using</span><span class="token punctuation">:</span> <span class="token string">'node12'</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span> <span class="token string">'./debug.js'</span></code></pre></div><p>There are <a href="https://help.github.com/en/articles/metadata-syntax-for-github-actions">more configuration options available</a> for actions but this represents the minimum amount needed to run. Specifically, it gives the action a name (which does not need to match the name of the folder) and points to the the code <code class="language-text">./debug.js</code>. Unfortunately, we don’t have a file called <code class="language-text">debug.js</code>, we have a file called <code class="language-text">debug.ts</code>.</p><p>GitHub Actions have built-in support for JavaScript and cannot run TypeScript directly. Because of this we will need to <em>transpile</em> our TypeScript to JavaScript before it can be run. This is done with <code class="language-text">tsc</code> (the TypeScript compiler). We’ve already included a task:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> run build</code></pre></div><p>This will generate JavaScript files <code class="language-text">debug.js</code> (and <code class="language-text">debug.test.js</code>):</p><div class="gatsby-highlight" data-language="js"><pre class="language-js"><code class="language-js"><span class="token string">'use strict'</span>
<span class="token keyword">var</span> __importStar <span class="token operator">=</span>
  <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__importStar<span class="token punctuation">)</span> <span class="token operator">||</span>
  <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">mod</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mod <span class="token operator">&amp;&amp;</span> mod<span class="token punctuation">.</span>__esModule<span class="token punctuation">)</span> <span class="token keyword">return</span> mod
    <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>mod <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> k <span class="token keyword">in</span> mod<span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">hasOwnProperty</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>mod<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span> result<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> mod<span class="token punctuation">[</span>k<span class="token punctuation">]</span>
    result<span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span> <span class="token operator">=</span> mod
    <span class="token keyword">return</span> result
  <span class="token punctuation">}</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>exports<span class="token punctuation">,</span> <span class="token string">'__esModule'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>value<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> core <span class="token operator">=</span> <span class="token function">__importStar</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@actions/core'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
exports<span class="token punctuation">.</span>default <span class="token operator">=</span> run</code></pre></div><p>In our setup we’ve ignored these files - they will not be included when we push our code to GitHub. This isn’t the recommended setup; GitHub suggests you include the built files for your actions to save time when running your action (and to reduce the dependencies needed by your action on the server). When developing actions it is easy to forget to build your code with each change. Because of this I’ve chosen to automatically build on execution (even though it is slower)<label for="sd-taking-a-few-extra" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-taking-a-few-extra" class="margin-toggle" /><span class="sidenote">Taking a few extra seconds to build your action on execution may not seem like a big deal; but GitHub Actions have a limited about of <a href="https://github.com/features/actions">free</a> compute time. While developing an action this might not matter; but long-term those seconds can add up.</span>. When releasing the action it is best to include the built JavaScript.</p></section>
<section><h2 id="workflows" style="position:relative;"><a href="#workflows" aria-label="workflows permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Workflows</h2><p>In order to execute the <code class="language-text">debug-action</code> we’ve created we need to create a workflow. The <code class="language-text">action.yml</code> in our action defines <strong>the code</strong> to execute and the workflow defines <strong>when</strong> to execute it. Workflows should be kept in the <code class="language-text">.github/workflows</code> folder in your repository. Your repository may contain multiple workflows. Create <code class="language-text">.github/workflows/debug-workflow.yml</code>:</p><div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'Debug workflow'</span>
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Debug
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/debug<span class="token punctuation">-</span>action</code></pre></div><p>We’ve created a workflow that should be executed on <code class="language-text">[push]</code>. There are many different <a href="https://help.github.com/en/articles/events-that-trigger-workflows">events that trigger worklows</a>. By specifying <code class="language-text">[push]</code> we’re saying that every time new code is pushed to our GitHub repository our workflow should be executed. In this case we’ve chosen to execute our workflow using the <code class="language-text">ubuntu-latest</code> environment. The steps for a workflow can point to an action that should be used or a command that should be run. Here we use both.</p><p>The first step checks out our code using the <code class="language-text">actions/checkout@v1</code> action:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1
  <span class="token key atrule">with</span><span class="token punctuation">:</span>
    <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span></code></pre></div><p>The <code class="language-text">actions/checkout</code> action<label for="sd-the-code-for-less" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-the-code-for-less" class="margin-toggle" /><span class="sidenote">The code for <code>actions/checkout</code> lives <a href="https://github.com/actions/checkout">on github</a>. Where is the copy of your code located on the server? This path is exported to the <code>GITHUB_WORKSPACE</code> <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#default-environment-variables">default environment variable</a>.</span> checks out a copy of your code on the server where the workflow is running. We’ve set the fetch-depth to <code class="language-text">1</code> indicating we only want a shallow-clone.<label for="sd-a-shallow-clone-of" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-a-shallow-clone-of" class="margin-toggle" /><span class="sidenote">A shallow clone of the code ignores all of the history. Since our action doesn't use any of the history this is a good speedup.</span> When your action code is included in your <code class="language-text">.github</code> folder (as our <code class="language-text">debug-action</code> is), you must use the <code class="language-text">actions/checkout</code> action to checkout a copy of the code so that it can run.</p><p>The next two steps install our action dependencies and build it:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
<span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build</code></pre></div><p>Again, this is generally discouraged because it is slower and takes more resources. While developing, however it is much more simple.</p><p>Finally we use our debug action:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/debug<span class="token punctuation">-</span>action</code></pre></div><p>This should be enough to run our <code class="language-text">debug-action</code>. Let’s commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> status</code></pre></div><p>You should see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

  .github/actions/debug-action/action.yml
	.github/workflows/

nothing added to commit but untracked files present <span class="token punctuation">(</span>use <span class="token string">"git add"</span> to track<span class="token punctuation">)</span></code></pre></div><p>Let’s add the workflow:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Debug action and workflow configuration"</span></code></pre></div></section>
<section><h2 id="pushing-to-github" style="position:relative;"><a href="#pushing-to-github" aria-label="pushing to github permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Pushing to GitHub</h2><p>Our action and workflow are ready. All that’s left is to push to our repository on GitHub. Create a <a href="https://github.com/new">new repository</a>. I called mine <code class="language-text">example-github-action-typescript</code> and made it public.</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 745px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/b075ba625d97710b8c1a17f233aa1880/7e509/action-create-a-new-repository.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 105.31249999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAVCAIAAADJt1n/AAAACXBIWXMAAAsSAAALEgHS3X78AAACPklEQVQ4y41Uy5LTMBD0/38D3LiQ257gwo0jXCi2KmxI4vghvy3LetmW5NCyw1aATRZV11hxMjM90zMJhnHM87zxp66qqiyLLM+naTr/xwmkVLuf++MpOZzIPkyfDlGcpJR2Het7zmFgORfLR2/xZKx3znlnYywXgglN1dxKW3OD9/gO7631Fk8PYxa7XIyZ5yXzMAx10zDGQFlrdT7P1ns5YA3/4pkXBErpYxidojiKU8Z4LyToCSm5kIj7Ss3IUlR1lJCOixcyrPxuOqM8e6GHYkBkgADD+MxvdrO7xuwtYgKBFGK3fazbVqFipfaH8BQlSUpAnS/87yQPlJTbx2+HMMrLqqUdyfKUZAAEixMSE0I7ihgQinFGedPLjsv+4qy1zvKiKMuqrtFzEEaftGeh/UVpiUlQSCHhwwQVqpf60p0Aw9RSynqOJo/jZB2kcqtU6wUF2t8Fz34EPJYpsMGqmF164C6ef1hj3GTsX0CPgaCTjpQdIRmqQmbtyaLdIy7jNIE7MtxsGAJgWrEMtGNwRoHanwE1Iw5gb89ZAB217FB2xxhSKjXAS3r3AYEmY+4NCRiCMH63Ahvj5cWqMNa2dB3vdST+BcbTpoQcjyEmAzYMT7j8eNq1bYv0CI0u3syM9ldNQ4oiK4q8LLHHEBzKV3Xjl0RIc5t5cIZowhrpxn5y4wz9IHrXi7ppmRisu7tVscw2yYcH8mmTfvzafl934XqrlnOj5kMfvd1u3u0e3mzff86/XDnPr/6H/QIWv8BKbJxmlwAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Creating a new repository"
        title="Creating a new repository"
        src="/static/b075ba625d97710b8c1a17f233aa1880/7e509/action-create-a-new-repository.png"
        srcset="/static/b075ba625d97710b8c1a17f233aa1880/72799/action-create-a-new-repository.png 320w,
/static/b075ba625d97710b8c1a17f233aa1880/6af66/action-create-a-new-repository.png 640w,
/static/b075ba625d97710b8c1a17f233aa1880/7e509/action-create-a-new-repository.png 745w"
        sizes="(max-width: 745px) 100vw, 745px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Once you’ve created the repository you’ll need to click the <code class="language-text">SSH</code> button make sure to setup the remote for your repository to use <code class="language-text">ssh</code> instead of HTTPs:</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 975px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/7bce14b679800a0b17c30c2c183f0dd3/e548f/action-http-ssh.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 13.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAl0lEQVQI1x3L2w6DIBAEUP//6/rQmhqtyCIILhcVqwgmFpucTOZhpmjYSLgWxrccidAfphqQhGPOisoe5zVdPt7Wv+W45nBbwlU8301ZkxryR5VV+3jVhKlOIIGhpT1wKdFJtErndAJnuwS/n36P0zcVdLAweqIj2MT01uFBTQJ3MhMG45ma+nEC6XLJWgwsz2zkdutM+gHdl6Uk9WXKwgAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Choose ssh"
        title="Choose ssh"
        src="/static/7bce14b679800a0b17c30c2c183f0dd3/e548f/action-http-ssh.png"
        srcset="/static/7bce14b679800a0b17c30c2c183f0dd3/72799/action-http-ssh.png 320w,
/static/7bce14b679800a0b17c30c2c183f0dd3/6af66/action-http-ssh.png 640w,
/static/7bce14b679800a0b17c30c2c183f0dd3/e548f/action-http-ssh.png 975w"
        sizes="(max-width: 975px) 100vw, 975px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Unfortunately you can’t push workflow changes via HTTPs as it is considered an integration. If you try you’ll see something like the following when you try to push:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">Enumerating objects: <span class="token number">31</span>, done.
Counting objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">31</span>/31<span class="token punctuation">)</span>, done.
Delta compression using up to <span class="token number">12</span> threads
Compressing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">25</span>/25<span class="token punctuation">)</span>, done.
Writing objects: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">31</span>/31<span class="token punctuation">)</span>, <span class="token number">55.08</span> KiB <span class="token operator">|</span> <span class="token number">7.87</span> MiB/s, done.
Total <span class="token number">31</span> <span class="token punctuation">(</span>delta <span class="token number">6</span><span class="token punctuation">)</span>, reused <span class="token number">0</span> <span class="token punctuation">(</span>delta <span class="token number">0</span><span class="token punctuation">)</span>
remote: Resolving deltas: <span class="token number">100</span>% <span class="token punctuation">(</span><span class="token number">6</span>/6<span class="token punctuation">)</span>, done.
To https://github.com/jeffrafter/example-github-action-typescript.git
 <span class="token operator">!</span> <span class="token punctuation">[</span>remote rejected<span class="token punctuation">]</span> master -<span class="token operator">></span> master <span class="token punctuation">(</span>refusing to allow an integration to create or update .github/workflows/debug-workflow.yml<span class="token punctuation">)</span>
error: failed to push some refs to <span class="token string">'https://github.com/jeffrafter/example-github-action-typescript.git'</span></code></pre></div><p>Setup your remote by copying the instructions on the page for <code class="language-text">an existing repository from the command line</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> remote <span class="token function">add</span> origin git@github.com:jeffrafter/example-github-action-typescript.git</code></pre></div><p>Then push:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push -u origin master</code></pre></div><p>On GitHub, click on the <code class="language-text">Actions</code> tab of your repository and click on the running build. When complete you should see something like:</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1280px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a0a53f46e9ec9328b8f1d85f48976dc0/ea964/action-debug-first-run.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 58.4375%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsSAAALEgHS3X78AAABpUlEQVQoz4WQ2U7CUBCG+yZuLAVaoBSKDYuCNhE0rgnojT6NlyYmJr6TqMgiXBmCIsYulGOhBVqhDtQYMU08+XLyn2n/zMyPIWXIy9qrpAJtSX3hFamrqJrWV7W+Nvi+Z0LVBoIky+hD6iK4O12EiX3UQYooQ6knygpCH0O1N5mYk9kZgzBBm+Ppy/xzsGel1X5rv7camtrrK+imUCjc3tVq9XKlCpTKlfviQ/GhBICoVKuV6qNVhwr29KrUm52WNBB6Zq3Br3EZPx3106s4GfIFIzhJLbvJFXwKCIJighGWDDHeAO3w+LHcVeP4urlz8bR72cycF71MmmZYIhT1+GkwwB9Ob+AHeFpFwOULYobxqRufw5EBG70LYjzNRdgEm0hB2xWcsHraMjXrM7OuGxAAL4hr3BbNJsNs0ukLuAjKTYZwkrbFEwh/m0f6rDMvbB+dbO3l9vOnB/mz7OFJnNuJbWRtiW9uz5th7BQHbSkmBmNDPG6C+r3zb1xEcM7MCxKbTC86vfDtZzcrHltszAsOjxXsv8ybRSm2vrnkJmBaCPNfvgA5lW0c2T6SSQAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Completed action"
        title="Completed action"
        src="/static/a0a53f46e9ec9328b8f1d85f48976dc0/21b4d/action-debug-first-run.png"
        srcset="/static/a0a53f46e9ec9328b8f1d85f48976dc0/72799/action-debug-first-run.png 320w,
/static/a0a53f46e9ec9328b8f1d85f48976dc0/6af66/action-debug-first-run.png 640w,
/static/a0a53f46e9ec9328b8f1d85f48976dc0/21b4d/action-debug-first-run.png 1280w,
/static/a0a53f46e9ec9328b8f1d85f48976dc0/ea964/action-debug-first-run.png 1312w"
        sizes="(max-width: 1280px) 100vw, 1280px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>The action ran and the build was marked as complete. But we can’t see the debug information we added. By default, GitHub will <a href="https://github.com/actions/toolkit/blob/getting-started-docs/docs/action-debugging.md#step-debug-logs">not output debug information in the action logs</a>. To see debug output in the logs you need to add a new secret to your repository. Go to the <code class="language-text">Settings</code> tab of your repository and click <code class="language-text">Secrets</code> on the sidebar. Then click <code class="language-text">Add a new secret</code>. Set the name to <code class="language-text">ACTIONS_STEP_DEBUG</code> with the value <code class="language-text">true</code> and click <code class="language-text">Add</code>. Currently, there is no way to re-run an action. We’ll see the debug information when we push a new commit.</p></section>
<section><h2 id="using-action-input" style="position:relative;"><a href="#using-action-input" aria-label="using action input permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using action input</h2><p>By default GitHub injects <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#default-environment-variables">default environment variables</a> that can be used by your action including:</p><ul>
<li><code class="language-text">HOME</code></li>
<li><code class="language-text">GITHUB_WORKFLOW</code></li>
<li><code class="language-text">GITHUB_ACTION</code></li>
<li><code class="language-text">GITHUB_REPOSITORY</code></li>
<li><code class="language-text">GITHUB_EVENT_NAME</code></li>
<li><code class="language-text">GITHUB_EVENT_PATH</code></li>
<li><code class="language-text">GITHUB_WORKSPACE</code></li>
<li><code class="language-text">GITHUB_SHA</code></li>
<li><code class="language-text">GITHUB_REF</code></li>
<li><code class="language-text">GITHUB_HEAD_REF</code> (only in forks)</li>
<li><code class="language-text">GITHUB_BASE_REF</code> (only in forks)</li>
</ul><p>These are commonly used, but there are many instances where you want to change how an action runs based on configuration in each workflow that uses that action. Let’s add an input to our debug action that changes what the debug message says.</p><p>First, define the input and default in <code class="language-text">.github/debug-action/action.yml</code>:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'debug-action'</span>
<span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">'Outputs debug information'</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> <span class="token string">'jeffrafter'</span>
<span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token key atrule">amazing-creature</span><span class="token punctuation">:</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> What kind of amazing creature are you<span class="token punctuation">?</span>
    <span class="token key atrule">default</span><span class="token punctuation">:</span> person
<span class="token key atrule">runs</span><span class="token punctuation">:</span>
  <span class="token key atrule">using</span><span class="token punctuation">:</span> <span class="token string">'node12'</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span> <span class="token string">'./debug.js'</span></code></pre></div><p>We’ve defined a new input called <code class="language-text">amazing-creature</code>. When the action is executed the name will be will be converted to<code class="language-text">INPUT_AMAZING-CREATURE</code> and the value will be passed in via the process environment. Environment variable names normally wouldn’t have <code class="language-text">-</code> in them as we see in <code class="language-text">INPUT_AMAZING-CREATURE</code>. Because of the <code class="language-text">-</code> we need to access the values as strings. The key names in <a href="https://yaml.org/spec/1.2/spec.html#id2764044">YAML syntax</a> can vary wildly but only spaces are replaced with underscores. You could access the values directly <code class="language-text">process.env[&#39;INPUT_AMAZING-CREATURE&#39;]</code> but using <code class="language-text">getInput</code> as we have done is more future-proof. Let’s use it. Change <code class="language-text">.github/actions/debug-action/debug.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
  core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>If we save that file and re-run our tests we’ll see a new failure:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"> FAIL  .github/actions/debug-action/__tests__/debug.test.ts
  debug action debug messages
    ✕ outputs a debug message <span class="token punctuation">(</span>12ms<span class="token punctuation">)</span>

  ● debug action debug messages › outputs a debug message

    expect<span class="token punctuation">(</span>jest.fn<span class="token punctuation">(</span><span class="token punctuation">))</span>.toHaveBeenCalledWith<span class="token punctuation">(</span><span class="token punctuation">..</span>.expected<span class="token punctuation">)</span>

    Expected: <span class="token string">"👋 Hello! You are an amazing person! 🙌"</span>
    Received: <span class="token string">"👋 Hello! You are an amazing undefined! 🙌"</span>

    Number of calls: <span class="token number">1</span>

       <span class="token number">6</span> <span class="token operator">|</span>     const debugMock <span class="token operator">=</span> jest.spyOn<span class="token punctuation">(</span>core, <span class="token string">'debug'</span><span class="token punctuation">)</span>
       <span class="token number">7</span> <span class="token operator">|</span>     await run<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token operator">></span>  <span class="token number">8</span> <span class="token operator">|</span>     expect<span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span>.toHaveBeenCalledWith<span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
         <span class="token operator">|</span>                       ^
       <span class="token number">9</span> <span class="token operator">|</span>   <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token number">10</span> <span class="token operator">|</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token number">11</span> <span class="token operator">|</span>

      at Object.it <span class="token punctuation">(</span>.github/actions/debug-action/__tests__/debug.test.ts:8:23<span class="token punctuation">)</span>

Test Suites: <span class="token number">1</span> failed, <span class="token number">1</span> total
Tests:       <span class="token number">1</span> failed, <span class="token number">1</span> total
Snapshots:   <span class="token number">0</span> total
Time:        <span class="token number">1</span>.413s
Ran all <span class="token builtin class-name">test</span> suites.</code></pre></div><p>Being an amazing <code class="language-text">undefined</code> is not very gratifying. The problem is that our test doesn’t know about the environment variable <code class="language-text">INPUT_AMAZING-CREATURE</code>. Let’s set it in the test in <code class="language-text">.github/actions/debug-action/__tests__/debug.test.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> run <span class="token keyword">from</span> <span class="token string">'../debug'</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'debug action debug messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'outputs a debug message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_AMAZING-CREATURE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'person'</span>
    <span class="token keyword">const</span> debugMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
    <span class="token keyword">delete</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_AMAZING-CREATURE'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>Setting the environment variable directly will make our test pass. After our test is complete we remove the variable to reset our state. We could do this [setup and teardown] with <code class="language-text">beforeEach</code> and <code class="language-text">afterEach</code> callbacks:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> run <span class="token keyword">from</span> <span class="token string">'../debug'</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  jest<span class="token punctuation">.</span><span class="token function">resetModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_AMAZING-CREATURE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'person'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">delete</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_AMAZING-CREATURE'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'debug action debug messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'outputs a debug message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> debugMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>We’ve also called <code class="language-text">jest.resetModules()</code> which will prevent other imported modules from using a cached value. The test should still pass.</p><p>What if you have a lot of inputs? It would be nice to automatically import all of the defaults. To do this we’ll need to read the <code class="language-text">action.yml</code> and assign all of the defaults to the environment. Install the type definitions for <code class="language-text">js-yaml</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @types/js-yaml</code></pre></div><p>And then lets expand our <code class="language-text">beforeEach</code> and <code class="language-text">afterEach</code> callbacks:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> run <span class="token keyword">from</span> <span class="token string">'../debug'</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">'fs'</span>
<span class="token keyword">import</span> yaml <span class="token keyword">from</span> <span class="token string">'js-yaml'</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  jest<span class="token punctuation">.</span><span class="token function">resetModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">safeLoad</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/../action.yml'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>inputs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>name <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> envVar <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">INPUT_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span>envVar<span class="token punctuation">]</span> <span class="token operator">=</span> doc<span class="token punctuation">.</span>inputs<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">safeLoad</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/../action.yml'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>inputs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>name <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> envVar <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">INPUT_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">delete</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span>envVar<span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'debug action debug messages'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'outputs a debug message'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> debugMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>While this is cool, it probably adds complexity rather than reducing it. Still, it is helpful to get an idea of how the action is being executed.</p><p>Our workflow can take advantage of the newly created property:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'Debug workflow'</span>
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Debug
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/debug<span class="token punctuation">-</span>action
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">amazing-creature</span><span class="token punctuation">:</span> Octocat</code></pre></div><p>We’ve added a <code class="language-text">with</code> node to our action definition and specified the value <code class="language-text">Octocat</code> as our <code class="language-text">amazing-creature</code>. Let’s commit and push these changes to GitHub. We should see the output this time because we turned debug output on. Check <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   .github/actions/debug-action/__tests__/debug.test.ts
	modified:   .github/actions/debug-action/action.yml
	modified:   .github/actions/debug-action/debug.ts
	modified:   .github/workflows/debug-workflow.yml
	modified:   package-lock.json
	modified:   package.json

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>That’s a lot of files. Add all of them:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Add amazing-creature input"</span></code></pre></div><p>Finally let’s push to GitHub:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push origin master</code></pre></div><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 661px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/2032a8e31d9ad2be618c66acbf77c72b/0012b/action-amazing-octocat.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 44.0625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABhUlEQVQoz22QWW/aQBSF+SktS/EYGy/gGRuM43XG4zUQgxeqhES0SlLlKf9f6rVbVTxU+uZoFp05V2dkunGYH1lx4vuG79v4vkkOLStrWp4cWgC7CMhvsQeFp5EZxGl1rs7X7vLePr22l7fzy6/26Q1u/OQBCNJjkJ6irKZ5G2XNoP3GT6rRRJAFWefR5ZB+8PCZBY+h24F6zjFw68jvMKaKZhtGaJoxJhSUmLGBI0mxejOSVzx6LJNXFnwHvLsKbDu7QLIxX+hTpIwFaTyXvs7FWyaC9Cd5FXhNzq6u87DblkvVFmVjhtQv39B4vviLIE3RcoaUmTiAFDgOyctVQp/r8jNnP2Dm0Os03V2vQ0K4YUSWlVpWQggTl2QyfPGP3rxQcc5fDtl7zq/32U8WtmviSRqWNAJ1TPsobSbqEHjr7M2w5JXJWMNoU2RpmnauX/hhSWkVs9q2U4yhJ0/T1SlS/2OGsTdW1pe0ibdWbhKuag7B8c4+wNGx966z3276zmHMW/Nvm+SAZtjdrJoAAAAASUVORK5CYII='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Debug output of the action shows amazing Octocat"
        title="Debug output of the action shows amazing Octocat"
        src="/static/2032a8e31d9ad2be618c66acbf77c72b/0012b/action-amazing-octocat.png"
        srcset="/static/2032a8e31d9ad2be618c66acbf77c72b/72799/action-amazing-octocat.png 320w,
/static/2032a8e31d9ad2be618c66acbf77c72b/6af66/action-amazing-octocat.png 640w,
/static/2032a8e31d9ad2be618c66acbf77c72b/0012b/action-amazing-octocat.png 661w"
        sizes="(max-width: 661px) 100vw, 661px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p></section>
<section><h2 id="action-outputs" style="position:relative;"><a href="#action-outputs" aria-label="action outputs permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Action outputs</h2><p>Debugging output is useful but actions are much more powerful when chained together. Each action can define a set of <a href="https://help.github.com/en/articles/metadata-syntax-for-github-actions#outputs">outputs</a> that can be used by subsequent actions.<label for="sd-the-less-than-a-href" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-the-less-than-a-href" class="margin-toggle" /><span class="sidenote">The <a href="https://github.com/actions/toolkit/blob/master/packages/core/README.md">README</a> for the GitHub Actions toolkit <code>core</code> package has some great examples of inputs, outputs, exporting variables and more.</span> Additionally an action can set it’s <a href="https://help.github.com/en/articles/creating-a-javascript-action#write-the-action-code">status</a>. This is especially useful for pull request workflows as the statuses can be used for automated-approval (or rejection).</p><p>Suppose we want to set an output containing our message so that other steps in our workflow can use it. We can define the output in our <code class="language-text">action.yml</code>:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'debug-action'</span>
<span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">'Outputs debug information'</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> <span class="token string">'jeffrafter'</span>
<span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token key atrule">amazing-creature</span><span class="token punctuation">:</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> What kind of amazing creature are you<span class="token punctuation">?</span>
    <span class="token key atrule">default</span><span class="token punctuation">:</span> person
<span class="token key atrule">outputs</span><span class="token punctuation">:</span>
  <span class="token key atrule">amazing-message</span><span class="token punctuation">:</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> We said something nice<span class="token punctuation">,</span> this was what we said.
<span class="token key atrule">runs</span><span class="token punctuation">:</span>
  <span class="token key atrule">using</span><span class="token punctuation">:</span> <span class="token string">'node12'</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span> <span class="token string">'./debug.js'</span></code></pre></div><p>Here we’ve called it <code class="language-text">amazing-message</code> and set the <code class="language-text">description</code>. In <code class="language-text">debug.ts</code> let’s use it:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span>
  core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
  core<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token string">'amazing-message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>We can add a test for this:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'debug action output'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'sets the action output'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> setOutputMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'setOutput'</span><span class="token punctuation">)</span>
    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>setOutputMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span>
      <span class="token string">'amazing-message'</span><span class="token punctuation">,</span>
      <span class="token string">'👋 Hello! You are an amazing person! 🙌'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>We can use the output in our workflow:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Debug
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/debug<span class="token punctuation">-</span>action
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">amazing-creature</span><span class="token punctuation">:</span> Octocat
        <span class="token key atrule">id</span><span class="token punctuation">:</span> debug
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> echo There was an amazing message <span class="token punctuation">-</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> steps.debug.outputs.amazing<span class="token punctuation">-</span>message <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></div><p>We’ve given our action an <code class="language-text">id</code> node, then we refer to that <code class="language-text">id</code> in our echo command. Let’s commit this. Run <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   .github/actions/debug-action/__tests__/debug.test.ts
	modified:   .github/actions/debug-action/action.yml
	modified:   .github/actions/debug-action/debug.ts
	modified:   .github/workflows/debug-workflow.yml

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>Add the changes:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Set the debug action output"</span></code></pre></div><p>And push it to GitHub:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push origin master</code></pre></div><p>Once we’ve push this to GitHub we’ll see:</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 884px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/0fc6b6c9126e3b1944a4f96a153603b4/136a2/action-set-output.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 64.6875%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAACDklEQVQoz4WSWY+bMBSF81M62YGwr8HgDQhgIATIOpN0kqZq1Uqtqv7/hzqZeem0VaWjq6Mrffa51+7BrK7375e7Y70/cdM9fVgfr+3jpeXmdF2fPnZPV97sjtfmcMZ5Q1h7V0eLdU+25nG6aZvPZXlOswOMlgAzH2UA5SEpuZ/DNMAsIAXv2CB2wcIFiTknig1678ZCAKpt+bNKP+XxGQWdZcWmGWk6sqzEc3PTig2D3D3zPTb3Ci7XyWaK1xuKytxnefKMwpagDZdmQElxZ6onKq4g22NJGwrqUFR5HYnavaq8OZb03kCYYdQ27Cvwqyx+ZsnFnzNZ9VU9kDUgKs5QkIeC8qcGgsxvliGsu/KbZUUU7cr0CoNmIhkPE7E/nQ2mfydfdIN9wNjiouiB7cQUb02LSoo3mCojnvbf5CtMcLcuvxsWIWi9oEd+yljUb3Py8f4Lh+GyYV8cZ5HQI4adbuLBdMZjP0ykh8kt+W96AwNQ5MnFsilFZYT3nDdMwqUb/LVcYabzJfPdTm4yxpL6Jna7Xf7Ik2NCNwg2fAUYdQnZEbSKCQUg87zc9wsY1jCogY9lVXuFR6LihynLH7PsgGkdIkajitAqhFEUVQAyREoSLaO4RriwbNCfyv2p2J9ILzcrXrBI4h1Gq4i2mKwILhBiQbi8daI1hBXBNZ/IdXPHSW0n4dvhH4nDvwCgILDSt389aAAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="The output message printed using echo in the action run"
        title="The output message printed using echo in the action run"
        src="/static/0fc6b6c9126e3b1944a4f96a153603b4/136a2/action-set-output.png"
        srcset="/static/0fc6b6c9126e3b1944a4f96a153603b4/72799/action-set-output.png 320w,
/static/0fc6b6c9126e3b1944a4f96a153603b4/6af66/action-set-output.png 640w,
/static/0fc6b6c9126e3b1944a4f96a153603b4/136a2/action-set-output.png 884w"
        sizes="(max-width: 884px) 100vw, 884px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Each action can have multiple outputs.</p></section>
<section><h2 id="setting-status-of-the-action" style="position:relative;"><a href="#setting-status-of-the-action" aria-label="setting status of the action permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting status of the action</h2><p>By default, if our action crashes it will fail. We can make this explicit:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span>
    core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    core<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token string">'amazing-message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Debug-action failure: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p>If the exception is handled and the program can continue we can make use of the logging functions instead:</p><ul>
<li><code class="language-text">core.error</code></li>
<li><code class="language-text">core.warning</code></li>
<li><code class="language-text">core.info</code><label for="sd-actually-less-than" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-actually-less-than" class="margin-toggle" /><span class="sidenote">Actually, <code>core.info</code> is not exposed by default. Instead, you can just use <code>console.log</code> which outputs directly to the log as well. In many ways using <code>console.log</code> is easier; but there is less built in formatting.</span></li>
</ul><p>Catching exceptions is great, but failures can happen for other reasons. For example, suppose someone chose <code class="language-text">mosquito</code> as the <code class="language-text">amazing-creature</code>. That’s not okay:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>creature <span class="token operator">===</span> <span class="token string">'mosquito'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token string">'Sorry, mosquitos are not amazing 🚫🦟'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span>
    core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    core<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token string">'amazing-message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Debug-action failure: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>We can test this in <code class="language-text">debug.test.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'does not output debug messages for non-amazing creatures'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_AMAZING-CREATURE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'mosquito'</span>
  <span class="token keyword">const</span> debugMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'debug'</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> setFailedMock <span class="token operator">=</span> jest<span class="token punctuation">.</span><span class="token function">spyOn</span><span class="token punctuation">(</span>core<span class="token punctuation">,</span> <span class="token string">'setFailed'</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>debugMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledTimes</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>setFailedMock<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toHaveBeenCalledWith</span><span class="token punctuation">(</span><span class="token string">'Sorry, mosquitos are not amazing 🚫🦟'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>Get the <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   .github/actions/debug-action/__tests__/debug.test.ts
	modified:   .github/actions/debug-action/debug.ts

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>Add and commit in one step:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -am <span class="token string">"Set failed status for debug action when necessary"</span></code></pre></div></section>
<section><h2 id="payloads" style="position:relative;"><a href="#payloads" aria-label="payloads permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Payloads</h2><p>Actions are intended to respond to events: when code is pushed, when a pull request is opened or updated, when someone leaves a comment, scheduled events, etc. Every action is passed a payload.</p><ul>
<li><a href="https://help.github.com/en/articles/events-that-trigger-workflows">Events that trigger workflows</a></li>
<li><a href="https://developer.github.com/v3/activity/events/types/">Event Types &#x26; Payloads</a></li>
</ul><p>The easiest way to work with a payload is to try it out and log the payload to the console:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> github <span class="token keyword">from</span> <span class="token string">'@actions/github'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>creature <span class="token operator">===</span> <span class="token string">'mosquito'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token string">'Sorry, mosquitos are not amazing 🚫🦟'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span>
    core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    core<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token string">'amazing-message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>

    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">{</span>payload<span class="token operator">:</span> github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Debug-action failure: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>Notice we added an import for the <code class="language-text">@actions/github</code> toolkit:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> github <span class="token keyword">from</span> <span class="token string">'@actions/github'</span></code></pre></div><p>Then we logged the <code class="language-text">github.context.payload</code>. If you push this to GitHub to run you might see:</p><div class="gatsby-highlight" data-language="json"><pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  payload<span class="token operator">:</span> <span class="token punctuation">{</span>
    after<span class="token operator">:</span> '152612b7cabe55f184249e24efbefb90035d4b3d'<span class="token punctuation">,</span>
    base_ref<span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>
    before<span class="token operator">:</span> 'e3f288e3adc5283e692f00fdec84c1da741d53e4'<span class="token punctuation">,</span>
    commits<span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
    compare<span class="token operator">:</span> 'https<span class="token operator">:</span><span class="token comment">//github.com/jeffrafter/example-github-action-typescript/compare/e3f288e3adc5...152612b7cabe',</span>
    created<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    deleted<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    forced<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    head_commit<span class="token operator">:</span> <span class="token punctuation">{</span>
      added<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      author<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span>
      committer<span class="token operator">:</span> <span class="token punctuation">[</span>Object<span class="token punctuation">]</span><span class="token punctuation">,</span>
      distinct<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      id<span class="token operator">:</span> '152612b7cabe55f184249e24efbefb90035d4b3d'<span class="token punctuation">,</span>
      message<span class="token operator">:</span> 'Use the action payload'<span class="token punctuation">,</span>
      modified<span class="token operator">:</span> <span class="token punctuation">[</span>Array<span class="token punctuation">]</span><span class="token punctuation">,</span>
      removed<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      timestamp<span class="token operator">:</span> '<span class="token number">2019</span><span class="token number">-09</span>-13T12<span class="token operator">:</span><span class="token number">27</span><span class="token operator">:</span><span class="token number">07</span><span class="token number">-07</span><span class="token operator">:</span><span class="token number">00</span>'<span class="token punctuation">,</span>
      tree_id<span class="token operator">:</span> '5fa0185e3911be4586a700e42cdb6e5e2c930e73'<span class="token punctuation">,</span>
      url<span class="token operator">:</span> 'https<span class="token operator">:</span><span class="token comment">//github.com/jeffrafter/example-github-action-typescript/commit/152612b7cabe55f184249e24efbefb90035d4b3d'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    pusher<span class="token operator">:</span> <span class="token punctuation">{</span> email<span class="token operator">:</span> 'jeffrafter@github.com'<span class="token punctuation">,</span> name<span class="token operator">:</span> 'jeffrafter' <span class="token punctuation">}</span><span class="token punctuation">,</span>
    ref<span class="token operator">:</span> 'refs/heads/master'
    <span class="token comment">// ... more output</span>
  <span class="token punctuation">}</span></code></pre></div><p>The <a href="https://developer.github.com/v3/activity/events/types/#pushevent">push event documentation</a> can be really helpful. With this information we can make our message more personal. We’ll include the name of the person pushing the code. Utilizing the information in the <code class="language-text">pusher</code> node is useful but that’s only available for <code class="language-text">push</code> actions. If you want to know who triggered the workflow for other kinds of actions you can use the <code class="language-text">GITHUB_ACTOR</code> <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#default-environment-variables">default environment variable</a>. In this case we’ll use the value from the payload. Change <code class="language-text">debug.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> github <span class="token keyword">from</span> <span class="token string">'@actions/github'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> creature <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'amazing-creature'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>creature <span class="token operator">===</span> <span class="token string">'mosquito'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token string">'Sorry, mosquitos are not amazing 🚫🦟'</span><span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> pusherName <span class="token operator">=</span> github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>pusher<span class="token punctuation">.</span>name
    <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">👋 Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>pusherName<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! You are an amazing </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>creature<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">! 🙌</span><span class="token template-punctuation string">`</span></span>
    core<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span>
    core<span class="token punctuation">.</span><span class="token function">setOutput</span><span class="token punctuation">(</span><span class="token string">'amazing-message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Debug-action failure: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>We’ll need to change our tests as well. We’ll directly set the payload in the <code class="language-text">beforeEach</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  jest<span class="token punctuation">.</span><span class="token function">resetModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> doc <span class="token operator">=</span> yaml<span class="token punctuation">.</span><span class="token function">safeLoad</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>__dirname <span class="token operator">+</span> <span class="token string">'/../action.yml'</span><span class="token punctuation">,</span> <span class="token string">'utf8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>doc<span class="token punctuation">.</span>inputs<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>name <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> envVar <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">INPUT_</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/ /g</span><span class="token punctuation">,</span> <span class="token string">'_'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span>envVar<span class="token punctuation">]</span> <span class="token operator">=</span> doc<span class="token punctuation">.</span>inputs<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'default'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>
    pusher<span class="token operator">:</span> <span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token string">'mona'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token keyword">as</span> WebhookPayload
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>We could <a href="https://github.com/actions/toolkit/blob/master/docs/github-package.md#mocking-the-github-context">store payloads as files and use those</a> as well, but this approach is more readable.</p><p>Run <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   .github/actions/debug-action/__tests__/debug.test.ts
	modified:   .github/actions/debug-action/debug.ts

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -am <span class="token string">"Use the action payload"</span></code></pre></div><p>And push to GitHub:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push origin master</code></pre></div><p>It is so encouraging!</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">There was an amazing message - 👋 Hello jeffrafter! You are an amazing Octocat! 🙌</code></pre></div><h1 id="give-some-love-to-anyone-that-opens-an-issue" style="position:relative;"><a href="#give-some-love-to-anyone-that-opens-an-issue" aria-label="give some love to anyone that opens an issue permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Give some love to anyone that opens an issue</h1><p>Writing output to the logs is fine. Setting the completion and failed status of the action is also cool. Automating your workflow using the API is the best. Actions can automatically create issues, pull request reviews, commits and more. To demonstrate, let’s create a new action. When a friendly contributor opens an issue in our repository our GitHub Action will thank them and add a reaction to their issue.</p><p>We’ll add the following:</p><div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">.github/
  actions/
    thanks-action/
      __tests__/
        thanks.test.ts
      action.yml
      thanks.js
      thanks.ts
  workflows/
    thanks-workflow.yml</code></pre></div></section>
<section><h2 id="using-the-api" style="position:relative;"><a href="#using-the-api" aria-label="using the api permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Using the API</h2><p>Every action that runs has access to a <code class="language-text">GITHUB_TOKEN</code> <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#default-environment-variables">environment variable</a> that can be used to interact with the API. The token has read and write (but not admin) <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#token-permissions">repository app permissions</a> by default.<label for="sd-note-forks-do-not" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-note-forks-do-not" class="margin-toggle" /><span class="sidenote">Note, forks do not normally have access to secrets in the actions environment. Forks do have access to a <code>GITHUB_TOKEN</code> but again, the permissions are limitted.</span></p><ul>
<li><a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#github_token-secret">Virtual Environments documentation</a></li>
</ul><p>To use the <code class="language-text">GITHUB_TOKEN</code> you must configure the environment of your action when it is referenced in the workflow. Remember actions can be used by many workflows in many repositories and granting access should be protected.
The workflow for our thanks action will be triggered when an issue is opened. Create <code class="language-text">.github/workflows/thanks-workflow.yml</code>:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Thanks workflow
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>issues<span class="token punctuation">]</span>

<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> Thanks
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">fetch-depth</span><span class="token punctuation">:</span> <span class="token number">1</span>
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm install
      <span class="token punctuation">-</span> <span class="token key atrule">run</span><span class="token punctuation">:</span> npm run build
      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> ./.github/actions/thanks<span class="token punctuation">-</span>action
        <span class="token key atrule">env</span><span class="token punctuation">:</span>
          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">id</span><span class="token punctuation">:</span> thanks</code></pre></div><p>Each step that makes use of the <code class="language-text">GITHUB_TOKEN</code> must include:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></div><p>We’ll also need a new <code class="language-text">action.yml</code> for our thanks action. Create <code class="language-text">.github/actions/thanks-action/action.yml</code>:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'thanks-action'</span>
<span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">'Says thanks when a contributor opens an issue'</span>
<span class="token key atrule">author</span><span class="token punctuation">:</span> <span class="token string">'jeffrafter'</span>
<span class="token key atrule">runs</span><span class="token punctuation">:</span>
  <span class="token key atrule">using</span><span class="token punctuation">:</span> <span class="token string">'node12'</span>
  <span class="token key atrule">main</span><span class="token punctuation">:</span> <span class="token string">'./thanks.js'</span>
<span class="token key atrule">inputs</span><span class="token punctuation">:</span>
  <span class="token key atrule">thanks-message</span><span class="token punctuation">:</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> Say thanks
    <span class="token key atrule">default</span><span class="token punctuation">:</span> Thanks for opening an issue ❤<span class="token tag">!</span></code></pre></div><p>Notice that we’ve specified an input with a default message. If we wanted we could specify different messages in our workflows that use this action.</p><p>With the environment set we’re ready to create <code class="language-text">.github/actions/thanks-action/thanks.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> core <span class="token keyword">from</span> <span class="token string">'@actions/core'</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> github <span class="token keyword">from</span> <span class="token string">'@actions/github'</span>

<span class="token keyword">const</span> run <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// Limit only to when issues are opened (not edited, closed, etc.)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>action <span class="token operator">!==</span> <span class="token string">'opened'</span><span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token comment">// Check the payload</span>
    <span class="token keyword">const</span> issue <span class="token operator">=</span> github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>issue
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>issue<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token keyword">const</span> token <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token keyword">return</span>

    <span class="token comment">// Create the octokit client</span>
    <span class="token keyword">const</span> octokit<span class="token operator">:</span> github<span class="token punctuation">.</span>GitHub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">github</span><span class="token punctuation">.</span><span class="token function">GitHub</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>
    <span class="token keyword">const</span> nwo <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_REPOSITORY'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'/'</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>owner<span class="token punctuation">,</span> repo<span class="token punctuation">]</span> <span class="token operator">=</span> nwo<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>

    <span class="token comment">// Reply with the thanks message</span>
    <span class="token comment">// https://octokit.github.io/rest.js/#octokit-routes-issues-create-comment</span>
    <span class="token keyword">const</span> thanksMessage <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'thanks-message'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> issueCommentResponse <span class="token operator">=</span> <span class="token keyword">await</span> octokit<span class="token punctuation">.</span>issues<span class="token punctuation">.</span><span class="token function">createComment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      owner<span class="token punctuation">,</span>
      repo<span class="token punctuation">,</span>
      issue_number<span class="token operator">:</span> issue<span class="token punctuation">.</span><span class="token builtin">number</span><span class="token punctuation">,</span>
      body<span class="token operator">:</span> thanksMessage<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Replied with thanks message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>issueCommentResponse<span class="token punctuation">.</span>data<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

    <span class="token comment">// Add a reaction</span>
    <span class="token comment">// https://octokit.github.io/rest.js/#octokit-routes-reactions-create-for-issue</span>
    <span class="token keyword">const</span> issueReactionResponse <span class="token operator">=</span> <span class="token keyword">await</span> octokit<span class="token punctuation">.</span>reactions<span class="token punctuation">.</span><span class="token function">createForIssue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      owner<span class="token punctuation">,</span>
      repo<span class="token punctuation">,</span>
      issue_number<span class="token operator">:</span> issue<span class="token punctuation">.</span><span class="token builtin">number</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span> <span class="token string">'heart'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Reacted: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>issueReactionResponse<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span>
    core<span class="token punctuation">.</span><span class="token function">setFailed</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Thanks-action failure: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>error<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> run</code></pre></div><p>Let’s break this down.</p><p>Using <code class="language-text">issues</code> events to trigger our workflow allows us to respond to newly opened issues. However, every change to an issue will trigger our workflow: when an issue is opened, closed, edited, assigned, etc. Because of this we want to make sure our action is only making changes when the issue is opened:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Limit only to when issues are opened (not edited, closed, etc.)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>action <span class="token operator">!==</span> <span class="token string">'opened'</span><span class="token punctuation">)</span> <span class="token keyword">return</span></code></pre></div><p>We’ll need to access the <code class="language-text">issue</code> in the payload:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Check the payload</span>
<span class="token keyword">const</span> issue <span class="token operator">=</span> github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload<span class="token punctuation">.</span>issue
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>issue<span class="token punctuation">)</span> <span class="token keyword">return</span></code></pre></div><p>At this point we grab the token that was injected into the environement from our workflow:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> token <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token keyword">return</span></code></pre></div><p>We use the token to create a new GitHub client:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Create the octokit client</span>
<span class="token keyword">const</span> octokit<span class="token operator">:</span> github<span class="token punctuation">.</span>GitHub <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">github</span><span class="token punctuation">.</span><span class="token function">GitHub</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span></code></pre></div><p>The client that is created is actually an <a href="https://octokit.github.io/rest.js/">octokit/rest.js</a> API client. The <code class="language-text">octokit</code> client has full access to the <a href="https://developer.github.com/v3/">Rest API V3</a>.<label for="sd-it-is-possible-to" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-it-is-possible-to" class="margin-toggle" /><span class="sidenote">It is possible to create an <a href="https://github.com/octokit/graphql.js">octokit/graphql.js</a> instance to access the V4 GraphQL API as well. See the documentation for working with custom requests.</span> There is great documentation available:</p><ul>
<li><a href="https://octokit.github.io/rest.js/">octokit/rest.js</a></li>
<li><a href="https://github.com/actions/toolkit/tree/master/packages/github">@actions/github</a></li>
<li><a href="https://developer.github.com/v3/">Rest API V3</a></li>
</ul><p>Once you have a <code class="language-text">octokit</code> client you’ll usually want to work with the current repository. There are a set of automatically included environment variables to make this easier. For example, the <code class="language-text">GITHUB_REPOSITORY</code> environment variable contains the repository name with owner (<code class="language-text">nwo</code>) like <code class="language-text">jeffrafter/example-github-action-typescript</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> nwo <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_REPOSITORY'</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">'/'</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>owner<span class="token punctuation">,</span> repo<span class="token punctuation">]</span> <span class="token operator">=</span> nwo<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span></code></pre></div><p>At this point we’re ready to create a comment replying to the opened issue. We grab the <code class="language-text">thanks-message</code> from the action input. Then we create the comment via the <code class="language-text">octokit/rest.js</code> client:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Reply with the thanks message</span>
<span class="token comment">// https://octokit.github.io/rest.js/#octokit-routes-issues-create-comment</span>
<span class="token keyword">const</span> thanksMessage <span class="token operator">=</span> core<span class="token punctuation">.</span><span class="token function">getInput</span><span class="token punctuation">(</span><span class="token string">'thanks-message'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> issueCommentResponse <span class="token operator">=</span> <span class="token keyword">await</span> octokit<span class="token punctuation">.</span>issues<span class="token punctuation">.</span><span class="token function">createComment</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  owner<span class="token punctuation">,</span>
  repo<span class="token punctuation">,</span>
  issue_number<span class="token operator">:</span> issue<span class="token punctuation">.</span><span class="token builtin">number</span><span class="token punctuation">,</span>
  body<span class="token operator">:</span> thanksMessage<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Replied with thanks message: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>issueCommentResponse<span class="token punctuation">.</span>data<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></code></pre></div><p>Calling the API requires HTTP interactions which are not instant. Because working with the API involves asynchronous callbacks, most API calls will return a <code class="language-text">Promise</code> containing a response object (with <code class="language-text">data</code>, <code class="language-text">status</code>, and <code class="language-text">headers</code>). if If you don’t care about the result, you can ignore the response and continue on. If you need to use the response, however, you’ll need to use <code class="language-text">await</code> to let the <code class="language-text">async</code> request complete. Here we are logging out the comment URL from the response so we need to use <code class="language-text">await</code> to make sure the response is complete.</p><p>We also want to add a reaction to the issue:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token comment">// Add a reaction</span>
<span class="token comment">// https://octokit.github.io/rest.js/#octokit-routes-reactions-create-for-issue</span>
<span class="token keyword">const</span> issueReactionResponse <span class="token operator">=</span> <span class="token keyword">await</span> octokit<span class="token punctuation">.</span>reactions<span class="token punctuation">.</span><span class="token function">createForIssue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  owner<span class="token punctuation">,</span>
  repo<span class="token punctuation">,</span>
  issue_number<span class="token operator">:</span> issue<span class="token punctuation">.</span><span class="token builtin">number</span><span class="token punctuation">,</span>
  content<span class="token operator">:</span> <span class="token string">'heart'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Reacted: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>issueReactionResponse<span class="token punctuation">.</span>data<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span></code></pre></div><p>Again we use <code class="language-text">await</code> to wait for the response from the API call.</p><h3 id="testing-api-interactions" style="position:relative;"><a href="#testing-api-interactions" aria-label="testing api interactions permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testing API interactions</h3><p>Whem working with the API it is important to configure your tests so they don’t actually interact with GitHub’s API. In general, you don’t want your tests to call the API directly; they might start creating real issues in your repositories or use up your rate limits. Instead you should be mocking all of the external calls from your test suite. This will also make your tests run faster.</p><p>It is common to use <code class="language-text">nock</code> to mock external requests and responses. Install it along with the supporting types:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev nock @types/nock</code></pre></div><blockquote>
<p>There are great examples available in the <code class="language-text">@actions/toolkit</code> repository on <a href="https://github.com/actions/toolkit/blob/master/docs/github-package.md#mocking-the-octokit-client">mocking the octokit client</a> and in the <code class="language-text">nock</code> <a href="https://github.com/nock/nock">README</a>.</p>
</blockquote><p>By default, we want to disable all external calls from our test suite. To do this add the following to the top of <code class="language-text">jest.config.js</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> nock <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'nock'</span><span class="token punctuation">)</span>
nock<span class="token punctuation">.</span><span class="token function">disableNetConnect</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre></div><p>Now if one of our tests attempts use the API nock will prevent it and fail the test with an error like:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">request to https://api.github.com/repos/sample/repository/issues/1/reactions failed, reason: Nock: No match <span class="token keyword">for</span> request</code></pre></div><p>Let’s create a new test. Create <code class="language-text">.github/actions/thanks-action/__tests__/thanks.test.ts</code>:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> github <span class="token keyword">from</span> <span class="token string">'@actions/github'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>WebhookPayload<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@actions/github/lib/interfaces'</span>
<span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">'nock'</span>
<span class="token keyword">import</span> run <span class="token keyword">from</span> <span class="token string">'../thanks'</span>

<span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  jest<span class="token punctuation">.</span><span class="token function">resetModules</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

  github<span class="token punctuation">.</span>context<span class="token punctuation">.</span>payload <span class="token operator">=</span> <span class="token punctuation">{</span>
    action<span class="token operator">:</span> <span class="token string">'opened'</span><span class="token punctuation">,</span>
    issue<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token builtin">number</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span> <span class="token keyword">as</span> WebhookPayload
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'thanks action'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'adds a thanks comment and heart reaction'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_THANKS-MESSAGE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Thanks for opening an issue ❤!'</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_REPOSITORY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'example/repository'</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'12345'</span>

    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">'https://api.github.com'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
        <span class="token string">'/repos/example/repository/issues/1/comments'</span><span class="token punctuation">,</span>
        body <span class="token operator">=></span> body<span class="token punctuation">.</span>body <span class="token operator">===</span> <span class="token string">'Thanks for opening an issue ❤!'</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>url<span class="token operator">:</span> <span class="token string">'https://github.com/example/repository/issues/1#comment'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">'https://api.github.com'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/repos/example/repository/issues/1/reactions'</span><span class="token punctuation">,</span> body <span class="token operator">=></span> body<span class="token punctuation">.</span>content <span class="token operator">===</span> <span class="token string">'heart'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>content<span class="token operator">:</span> <span class="token string">'heart'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>We start off by setting up a fake payload. The real payload (when GitHub runs our action) will be much bigger and contain more information<label for="sd-when-you-are-first" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-when-you-are-first" class="margin-toggle" /><span class="sidenote">When you are first working with a GitHub Action it is sometimes helpful to start with a <code>console.log</code> for the whole payload. You can copy the output from the logs and use it as your default payload while testing. Additionally, the <a href="https://developer.github.com/v3/activity/events/types/">Event Types &#x26; Payloads</a> documentation contains sample payloads if you can't use the <code>console.log</code> trick.</span>; however we’ve made our example payload in the test as small as possible to keep things focused.</p><p>The test that we’ve created does nothing more than attempt to run our action. We’re not verifying any output or debug information (though we could). Instead we are validating that the API endpoints are hit with specific parameters. If these mocked API requests don’t occur (as we have specified them), the test will fail:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'adds a thanks comment and heart reaction'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'INPUT_THANKS-MESSAGE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Thanks for opening an issue ❤!'</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_REPOSITORY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'example/repository'</span>
  process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'12345'</span>

  <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">'https://api.github.com'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span>
      <span class="token string">'/repos/example/repository/issues/1/comments'</span><span class="token punctuation">,</span>
      body <span class="token operator">=></span> body<span class="token punctuation">.</span>body <span class="token operator">===</span> <span class="token string">'Thanks for opening an issue ❤!'</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>url<span class="token operator">:</span> <span class="token string">'https://github.com/example/repository/issues/1#comment'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">nock</span><span class="token punctuation">(</span><span class="token string">'https://api.github.com'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/repos/example/repository/issues/1/reactions'</span><span class="token punctuation">,</span> body <span class="token operator">=></span> body<span class="token punctuation">.</span>content <span class="token operator">===</span> <span class="token string">'heart'</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>content<span class="token operator">:</span> <span class="token string">'heart'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token keyword">await</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div><p>Notice that we are also specifying the response body. This allows our action code to utilize the response exactly as it would from a real API interaction. Again, when developing your action you might use <code class="language-text">console.log</code> to see what the actual output looks like before setting up your tests.</p><p>Some might argue that this level of mocking for your tests is too much. We’re faking the input, faking the API endpint and faking the responses. So what is this test even doing? The approach here is one of efficiency. I’m trusting that the GitHub API works and that the way I’ve set it up won’t change. With those assumptions set in my tests, I’m free to change the code that leads up to those interactions in any way I see fit. I’ve mocked the edges, but my actions code still must do the right thing. It’s a trade-off but once you’ve established how the edges of your code work it allows much faster iteration.</p><p>If we run the tests with <code class="language-text">npm test</code> we see:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"> PASS  .github/actions/debug-action/__tests__/debug.test.ts
  debug action debug messages
    ✓ outputs a debug message <span class="token punctuation">(</span>11ms<span class="token punctuation">)</span>
    ✓ does not output debug messages <span class="token keyword">for</span> non-amazing creatures <span class="token punctuation">(</span>2ms<span class="token punctuation">)</span>
  debug action output
    ✓ sets the action output <span class="token punctuation">(</span>1ms<span class="token punctuation">)</span>

 PASS  .github/actions/thanks-action/__tests__/thanks.test.ts
  thanks action
    ✓ adds a thanks comment and heart reaction <span class="token punctuation">(</span>30ms<span class="token punctuation">)</span>

Test Suites: <span class="token number">2</span> passed, <span class="token number">2</span> total
Tests:       <span class="token number">4</span> passed, <span class="token number">4</span> total
Snapshots:   <span class="token number">0</span> total
Time:        <span class="token number">2</span>.194s
Ran all <span class="token builtin class-name">test</span> suites.
  console.log .github/actions/thanks-action/thanks.ts:30
    Replied with thanks message: https://github.com/example/repository/issues/1<span class="token comment">#comment</span>

  console.log .github/actions/thanks-action/thanks.ts:40
    Reacted: heart</code></pre></div><p>At this point the action works. Let’s check <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   jest.config.js
	modified:   package-lock.json
	modified:   package.json

Untracked files:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to include <span class="token keyword">in</span> what will be committed<span class="token punctuation">)</span>

	.github/actions/thanks-action/
	.github/workflows/thanks-workflow.yml

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>Let’s add all of those:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> <span class="token function">add</span> <span class="token builtin class-name">.</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -m <span class="token string">"Thanks action"</span></code></pre></div><p>And push to GitHub:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push origin master</code></pre></div><p>When we pushed, our <code class="language-text">debug-action</code> still executed, but not our new <code class="language-text">thanks-action</code>. In order to trigger that we have to open a new issue. Open a new issue with any message and then watch the action execute. You should see something like:</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 754px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/29edeabc5f8acb5d2d3fe36028701354/7527b/action-bot-response.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 15%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsSAAALEgHS3X78AAAAe0lEQVQI13WL2wrCMBBE8//v+aE81M+oiKjtpkk2SXO1WVefRPAwDAeGEVLKaTpZDJfr7b4AC2x2MQjaPFZtMOTaU2nf2VPRxuXahFJqns9xT5ux1iH6iM5HAN5SLtytP39SW+eJRRDRGCPEiB6Z991hg5U+jH8QHeN4Abxbqq0LRPFCAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="A bot replying with a thanks message"
        title="A bot replying with a thanks message"
        src="/static/29edeabc5f8acb5d2d3fe36028701354/7527b/action-bot-response.png"
        srcset="/static/29edeabc5f8acb5d2d3fe36028701354/72799/action-bot-response.png 320w,
/static/29edeabc5f8acb5d2d3fe36028701354/6af66/action-bot-response.png 640w,
/static/29edeabc5f8acb5d2d3fe36028701354/7527b/action-bot-response.png 754w"
        sizes="(max-width: 754px) 100vw, 754px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>It works! But… it doesn’t feel very personal to have a bot replying to collaborators. It would feel much better if a human were replying. Unfortunately all of the interactions with the repository are on behalf of the GitHub Actions bot because we are using the <code class="language-text">GITHUB_TOKEN</code>. In order to act on behalf of another user we’ll need to use a different token. o do this, we’ll generate a <a href="https://help.github.com/en/articles/creating-a-personal-access-token-for-the-command-line">personal access token</a>.<label for="sd-note-personal-access" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-note-personal-access" class="margin-toggle" /><span class="sidenote">Note: personal access tokens are powerful things and should be kept secret. They allow applications (and GitHub actions) to impersonate you and act on your behalf. You should never check a personal access token into version control or share it on the Internet. If you've accidently done that, go to your settings and delete the token to revoke access.</span></p><p>To create a token, go to your <a href="https://github.com/settings/tokens">token settings</a> in GitHub (click on <code class="language-text">Settings</code> in the user drop-down menu, then <code class="language-text">Developer settings</code> in the sidebar, then click on <code class="language-text">Personal access tokens</code>). Then click the <code class="language-text">Generate new token</code> button.</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABg0lEQVQoz5WT626DMAyFef8X3J92WymXQggECoQkwJltWm1r6aRF+uS4KofjC1GW57gUBS6XYou3e5ZfMM8z/nuiUilUWm9UGkpV0HJXcJNF8A7eOYkh+C0S0zQJzt3uFJdlRRSfEyRpijTNKBJJgnOucEhqfKQax0TjPa0or/CZN5IzqqpR1zUaY8jAFpdlQTQMg1gN3sMz9CYXFkwBcPMGpRL5N8aGP0p+O6Q4xiWq1qPpF9RXZn5CE5MnZazCuu4TqbpDqTs0nSVn3y42Vji/MRHco/vhh/eEo9PpE6c4hrWjlOup4dxo56jhPoioCBOWHI5uwXwTXtedktO8gKbmtl2HumlgTEt5I5PWZkDZBRRmIhyqa5BcSn9Vcq46WQ+e0P30NCjTtiRuhL6/YhyHX072xGTK1lpkWY6iLOmhUf7cth2thRbYrXP+SWTviCCL8A6WpaLF3fbBkGBBOQtybKgNr1z9fIEI8gD4axlu7qTkfpBFlbJJnOO9JY/uHgW/AEMipTHoeCN0AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Creating a thanks-action personal access token"
        title="Creating a thanks-action personal access token"
        src="/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png"
        srcset="/static/8689d1b3de39e9e17f19f277064679f8/72799/action-create-token.png 320w,
/static/8689d1b3de39e9e17f19f277064679f8/6af66/action-create-token.png 640w,
/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png 764w"
        sizes="(max-width: 764px) 100vw, 764px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Make sure you’ve checked the <code class="language-text">repo</code> box to grant repository access permissions to the token. Copy the token (note, this is just an example and this token has been revoked so you can’t use it):</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 764px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 57.50000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsSAAALEgHS3X78AAABg0lEQVQoz5WT626DMAyFef8X3J92WymXQggECoQkwJltWm1r6aRF+uS4KofjC1GW57gUBS6XYou3e5ZfMM8z/nuiUilUWm9UGkpV0HJXcJNF8A7eOYkh+C0S0zQJzt3uFJdlRRSfEyRpijTNKBJJgnOucEhqfKQax0TjPa0or/CZN5IzqqpR1zUaY8jAFpdlQTQMg1gN3sMz9CYXFkwBcPMGpRL5N8aGP0p+O6Q4xiWq1qPpF9RXZn5CE5MnZazCuu4TqbpDqTs0nSVn3y42Vji/MRHco/vhh/eEo9PpE6c4hrWjlOup4dxo56jhPoioCBOWHI5uwXwTXtedktO8gKbmtl2HumlgTEt5I5PWZkDZBRRmIhyqa5BcSn9Vcq46WQ+e0P30NCjTtiRuhL6/YhyHX072xGTK1lpkWY6iLOmhUf7cth2thRbYrXP+SWTviCCL8A6WpaLF3fbBkGBBOQtybKgNr1z9fIEI8gD4axlu7qTkfpBFlbJJnOO9JY/uHgW/AEMipTHoeCN0AAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Copy the personal access token"
        title="Copy the personal access token"
        src="/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png"
        srcset="/static/8689d1b3de39e9e17f19f277064679f8/72799/action-create-token.png 320w,
/static/8689d1b3de39e9e17f19f277064679f8/6af66/action-create-token.png 640w,
/static/8689d1b3de39e9e17f19f277064679f8/f3c12/action-create-token.png 764w"
        sizes="(max-width: 764px) 100vw, 764px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Next, we’ll need to add a new secret to our repository. Open the setings for your repository and click <code class="language-text">Secrets</code> in the sidebar. Click <code class="language-text">Add a new secret</code> and set the name to <code class="language-text">THANKS_USER_TOKEN</code> and paste the copied personal access token into the <code class="language-text">Value</code>. Click <code class="language-text">Add secret</code>.<label for="sd-repository-secrets" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sd-repository-secrets" class="margin-toggle" /><span class="sidenote">Repository secrets are extremely powerful. We can use them to configure keys to external services, setup CI and control our environment. For more information see <a href="https://help.github.com/en/articles/virtual-environments-for-github-actions#creating-and-using-secrets-encrypted-variables">Creating and using secrets</a>.</span></p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 751px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/c422c9a30dab66b77fef20c3d1ffb957/c483d/action-secrets.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 40.3125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAA30lEQVQoz52Q62rDMAxG8/7vuPXPoCxp4lt8k+18k+wuK2OMrYKDJQs+jj3Ny4KX1wusdXimjkM4TibvPdZtw77viCl1QohI0scE2YcQxi7GfjfO0bfWRlj7DNw9nN0ZB600rLFY1w3aGCie53nB7bZCa4NNqX4n9F5r1Fq/bJmJGsGQgyMOLoP/VhKp6zuICqZcCLEkpJJPRL+xfpOTn9Q550dat6JMCM6jlMqBNUNlBZ01TDbdFN8++jekIhuatysbkhg2aF+hfIEN9c9BPyHGE3GgBBnGxXpfPME98APKY3QxgTSN9QAAAABJRU5ErkJggg=='); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Action secrets"
        title="Action secrets"
        src="/static/c422c9a30dab66b77fef20c3d1ffb957/c483d/action-secrets.png"
        srcset="/static/c422c9a30dab66b77fef20c3d1ffb957/72799/action-secrets.png 320w,
/static/c422c9a30dab66b77fef20c3d1ffb957/6af66/action-secrets.png 640w,
/static/c422c9a30dab66b77fef20c3d1ffb957/c483d/action-secrets.png 751w"
        sizes="(max-width: 751px) 100vw, 751px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><p>Now that we’ve created a new secret containing our token we need to use it. To use it, we’ll need to modify our workflow. Right now the <code class="language-text">env</code> node in our workflow specifies the <code class="language-text">GITHUB_TOKEN</code>.</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></div><p>Let’s add an entry for the <code class="language-text">THANKS_USER_TOKEN</code>:</p><div class="gatsby-highlight" data-language="yml"><pre class="language-yml"><code class="language-yml"><span class="token key atrule">env</span><span class="token punctuation">:</span>
  <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">THANKS_USER_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.THANKS_USER_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre></div><p>This will inject the secret into our environment. We’ll need to modify <code class="language-text">thanks.ts</code> to use it. Currently we have:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> token <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span></code></pre></div><p>Let’s change that to:</p><div class="gatsby-highlight" data-language="ts"><pre class="language-ts"><code class="language-ts"><span class="token keyword">const</span> token <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'THANKS_USER_TOKEN'</span><span class="token punctuation">]</span> <span class="token operator">||</span> process<span class="token punctuation">.</span>env<span class="token punctuation">[</span><span class="token string">'GITHUB_TOKEN'</span><span class="token punctuation">]</span></code></pre></div><p>That’s it. At this point <code class="language-text">npm test</code> should still pass and <code class="language-text">npm run lint</code> should have no warnings or errors. Let’s check the <code class="language-text">git status</code>:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash">On branch master
Your branch is up to <span class="token function">date</span> with <span class="token string">'origin/master'</span><span class="token builtin class-name">.</span>

Changes not staged <span class="token keyword">for</span> commit:
  <span class="token punctuation">(</span>use <span class="token string">"git add &lt;file>..."</span> to update what will be committed<span class="token punctuation">)</span>
  <span class="token punctuation">(</span>use <span class="token string">"git checkout -- &lt;file>..."</span> to discard changes <span class="token keyword">in</span> working directory<span class="token punctuation">)</span>

	modified:   .github/actions/thanks-action/thanks.ts
	modified:   .github/workflows/thanks-workflow.yml

no changes added to commit <span class="token punctuation">(</span>use <span class="token string">"git add"</span> and/or <span class="token string">"git commit -a"</span><span class="token punctuation">)</span></code></pre></div><p>And commit:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> commit -am <span class="token string">"Make it more personal"</span></code></pre></div><p>Push it to GitHub:</p><div class="gatsby-highlight" data-language="bash"><pre class="language-bash"><code class="language-bash"><span class="token function">git</span> push origin master</code></pre></div><p>Open a new example issue and you should see your user account reply:</p><p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 757px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/955976d3bb26386011eba837ae381e28/1fbe8/action-personal-response.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 15.312499999999998%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkElEQVQI12WLMRKCMBREuf8JPIJ3sNXOFgu1ZQYCyP8JgUDMXz8ZG3Rn3myxb4vT8YDH7YLORVTmhY5nGPJoeUKjdIoLsmNcBDS91VNn2Nw5//ySUJTXM573EoMLqJoepmc0ytZ93YL9gnmVPRH5zH7N2El7DAhRUOAb5xystSBiEFtYIkRT502SQOSf3yT1PiAY5rjciyJGAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="A more personal response from a GitHub Action"
        title="A more personal response from a GitHub Action"
        src="/static/955976d3bb26386011eba837ae381e28/1fbe8/action-personal-response.png"
        srcset="/static/955976d3bb26386011eba837ae381e28/72799/action-personal-response.png 320w,
/static/955976d3bb26386011eba837ae381e28/6af66/action-personal-response.png 640w,
/static/955976d3bb26386011eba837ae381e28/1fbe8/action-personal-response.png 757w"
        sizes="(max-width: 757px) 100vw, 757px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p><h1 id="thanks" style="position:relative;"><a href="#thanks" aria-label="thanks permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Thanks</h1><p>Lots of folks @GitHub helped review and solve some of the issues I came across while writing this post. Special shout-outs go to <a href="https://github.com/jasonetco">@jasonetco</a>, <a href="https://github.com/mscoutermarsh">@mscoutermarsh</a>, and <a href="https://github.com/mikekavouras">@mikekavouras</a>. Also, special thanks to the docs team and the octokit/rest.js team who make great things.</p></section>
<div class="footnotes">
<hr>
<ol>
<li id="fn-shallow-clone">
<p>A shallow clone of the code ignores all of the history. Since our action doesn’t use any of the history this is a good speedup.</p>
<a href="#fnref-shallow-clone" class="footnote-backref">↩</a>
</li>
</ol>
</div></div><hr/><h2>Comments</h2><div class="sc-ifAKCX ddlDEo github"><div><p>Thanks for reading ❤️ – comment by replying to the <a href="https://github.com/jeffrafter/jeffrafter.github.io/issues/8">issue for this post</a>.<!-- --> <!-- -->There’s no comments yet; you could be the first.<br/></p></div><div class="sc-gzVnrw bOnSNx"><a href="https://github.com/jeffrafter/jeffrafter.github.io/issues/8#new_comment_field" target="_blank" rel="noreferrer noopener" class="button btn">Add a comment →</a></div></div><hr/><h2>There’s more to read</h2><div><p><em>Looking for more long-form posts? Here ya go...</em></p></div><ul class="sc-htoDjs gXLbcD"><li><a rel="prev" href="/oculus-quest/">← <!-- -->Developing for the Oculus Quest</a></li><li><a rel="next" href="/releasing-github-actions/">Releasing GitHub Actions<!-- --> →</a></li></ul></div></article></main><footer class="sc-bwzfXH aCPwf footer">© <!-- -->2025<!-- -->,<!-- --> <a href="https://jeffrafter.com">jeffrafter.com</a>. Built with<!-- --> <a href="https://www.gatsbyjs.org">Gatsby</a></footer></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-61511214-2', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/working-with-github-actions/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-51d0929071629bddce45.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-c709285770c005682b82.js"],"component---src-pages-about-tsx":["/component---src-pages-about-tsx-62b9eaa39bf8729ce54a.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-8c0fa96d2b2e2db049f0.js"],"component---src-pages-measure-tsx":["/component---src-pages-measure-tsx-fa53ce10f25ac34e39da.js"],"component---src-pages-tags-tsx":["/component---src-pages-tags-tsx-7578574f5e2dead3e222.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-7133ab7322325c379163.js"],"component---src-templates-tag-tsx":["/component---src-templates-tag-tsx-b66b8eb25d0cb13a4d3b.js"]};/*]]>*/</script><script src="/component---src-templates-post-tsx-7133ab7322325c379163.js" async=""></script><script src="/109cf451cc5d7f6d2abc8e688d09142e78350594-53a6b222a8910dfb5d1b.js" async=""></script><script src="/commons-6458b952aa116f5f11f8.js" async=""></script><script src="/app-51d0929071629bddce45.js" async=""></script><script src="/styles-24c541b6ac347bae38f1.js" async=""></script><script src="/framework-95b680cb3190aa9bfe59.js" async=""></script><script src="/webpack-runtime-9d81d0198458e5aa5952.js" async=""></script></body></html>