(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{R46c:function(e,t,n){"use strict";n.r(t),n.d(t,"pageQuery",(function(){return v}));n("VRzm"),n("f3/d"),n("a1Th"),n("Btvt"),n("XfO3"),n("HEwt"),n("rGqo"),n("rE2o"),n("ioFf"),n("pIFo");var r=n("o0o1"),a=n.n(r),l=(n("ls82"),n("q1tI")),o=n.n(l),c=n("9Dj+"),i=n("RnvD");function u(e,t,n,r,a,l,o){try{var c=e[l](o),i=c.value}catch(u){return void n(u)}c.done?t(i):Promise.resolve(i).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var l=e.apply(t,n);function o(e){u(l,r,a,o,c,"next",e)}function c(e){u(l,r,a,o,c,"throw",e)}o(void 0)}))}}function m(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var v="1228932282";t.default=function(e){var t=e.data,n=t.site.siteMetadata.title,r=t.site.siteMetadata.keywords,u=Object(l.useState)(!1),d=u[0],v=u[1],f=Object(l.useState)(!1),p=f[0],b=f[1],h=Object(l.useState)([]),g=h[0],y=h[1],E=Object(l.useState)(""),w=E[0],k=E[1],x=Object(l.useState)(""),S=x[0],j=x[1],R=Object(l.useRef)(),A=d?navigator.userAgent:"unknown";Object(l.useEffect)((function(){v(!0),R.current=function(e){var t,n,r,a,l,o,c=e.acceleration,i=e.rotationRate,u={ride:w,timestamp:Date.now(),accelX:null!==(t=null==c?void 0:c.x)&&void 0!==t?t:null,accelY:null!==(n=null==c?void 0:c.y)&&void 0!==n?n:null,accelZ:null!==(r=null==c?void 0:c.z)&&void 0!==r?r:null,rotAlpha:null!==(a=null==i?void 0:i.alpha)&&void 0!==a?a:null,rotBeta:null!==(l=null==i?void 0:i.beta)&&void 0!==l?l:null,rotGamma:null!==(o=null==i?void 0:i.gamma)&&void 0!==o?o:null,user:S,device:A};y((function(e){return[].concat(m(e),[u])}))}}),[w,S,A]);var O=function(){var e=s(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof DeviceMotionEvent.requestPermission){e.next=9;break}return e.next=3,DeviceMotionEvent.requestPermission();case 3:if("granted"===e.sent){e.next=7;break}return alert("Motion permission denied"),e.abrupt("return");case 7:e.next=11;break;case 9:return alert("Motion permission not available"),e.abrupt("return");case 11:window.addEventListener("devicemotion",R.current),b(!0);case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=["timestamp","accelX","accelY","accelZ","rotAlpha","rotBeta","rotGamma","ride","user","device"].join(","),t=g.map((function(e){return[e.timestamp,e.accelX,e.accelY,e.accelZ,e.rotAlpha,e.rotBeta,e.rotGamma,e.ride,'"'+e.user.replace(/"/g,'""')+'"','"'+e.device.replace(/"/g,'""')+'"'].join(",")}));return[e].concat(m(t)).join("\n")},L=function(){var e=s(a.a.mark((function e(){var t,n,r,l,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=M(),l=new Blob([r],{type:"text/csv"}),o=[new File([l],"motion-ride"+w+".csv",{type:"text/csv"})],!(null===(t=(n=navigator).canShare)||void 0===t?void 0:t.call(n,{files:o}))){e.next=14;break}return e.prev=4,e.next=7,navigator.share({files:o,title:"Motion Data",text:"Ride "+w+" data from "+S});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.error("Share failed",e.t0);case 12:e.next=15;break;case 14:alert("Sharing not supported; please download instead.");case 15:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(){return e.apply(this,arguments)}}(),C=g[g.length-1];return o.a.createElement(c.a,{title:n},o.a.createElement(i.a,{title:"Measure me",keywords:r}),o.a.createElement("article",null,o.a.createElement("h2",null,"ðŸŽ¢ Motion Recorder"),o.a.createElement("label",null,"Your name:",o.a.createElement("br",null),o.a.createElement("input",{type:"text",value:S,onChange:function(e){return j(e.target.value)}})),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("label",{style:{marginTop:"1rem"}},"Ride:",o.a.createElement("br",null),o.a.createElement("input",{type:"text",value:w,onChange:function(e){return k(e.target.value)}})),o.a.createElement("p",null,o.a.createElement("button",{onClick:p?function(){window.removeEventListener("devicemotion",R.current),b(!1)}:O},p?"Stop Recording":"Start Recording",C&&o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("small",null,"Last sample: ",C.timestamp," ",o.a.createElement("br",null),"Accel: ",C.accelX,", ",C.accelY,", ",C.accelZ," ",o.a.createElement("br",null),"Rot: ",C.rotAlpha,", ",C.rotBeta,", ",C.rotGamma))),o.a.createElement("button",{onClick:function(){var e=M(),t=new Blob([e],{type:"text/csv"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="motion-data-ride"+w+".csv",r.click(),URL.revokeObjectURL(n)},disabled:0===g.length,style:{marginLeft:"1rem"}},"Download CSV"),o.a.createElement("button",{onClick:L,disabled:0===g.length,style:{marginLeft:"1rem"}},"Share CSV")),o.a.createElement("p",null,p?"Recordingâ€¦ samples collected: "+g.length:"Not recording. Total samples: "+g.length)))}}}]);
//# sourceMappingURL=component---src-pages-measure-tsx-0ee342e2da5bd585f1fd.js.map